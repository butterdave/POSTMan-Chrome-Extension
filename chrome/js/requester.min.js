"use strict";function Collection(){this.id="",this.name="",this.requests={}}function CollectionRequest(){this.collectionId="",this.id="",this.name="",this.description="",this.url="",this.method="",this.headers="",this.data="",this.dataMode="params",this.timestamp=0}function Request(){this.id="",this.name="",this.description="",this.url="",this.method="",this.headers="",this.data="",this.dataMode="params",this.timestamp=0}function sortAlphabetical(a,b){var c;c=a.name.length>b.name.legnth?b.name.length:a.name.length;for(var d=0;c>d;d++)if(a.name[d]!=b.name[d])return a.name[d]>b.name[d]?1:-1;return 1}var pm={};pm.debug=!0,pm.indexedDB={},pm.indexedDB.db=null,pm.indexedDB.modes={readwrite:"readwrite",readonly:"readonly"},pm.fs={},pm.webUrl="https://www.getpostman.com",pm.bannedHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],window.indexedDB||(window.indexedDB=window.mozIndexedDB||window.webkitIndexedDB);var IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction,IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange,IDBCursor=window.IDBCursor||window.webkitIDBCursor;window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,pm.init=function(){Handlebars.partials=Handlebars.templates,pm.history.init(),pm.collections.init(),pm.settings.init(),pm.layout.init(),pm.editor.init(),pm.jsonlint.init(),pm.request.init(),pm.urlCache.refreshAutoComplete(),pm.helpers.init(),pm.keymap.init(),pm.envManager.init(),pm.filesystem.init(),pm.indexedDB.open(),pm.broadcasts.init(),$(":input:first").focus()},$(document).ready(function(){pm.init()}),$(window).on("unload",function(){pm.request.saveCurrentRequestToLocalStorage()}),pm.broadcasts={init:function(){var a=(localStorage.broadcasts,localStorage.broadcast_last_update_time),b=new Date;if(pm.broadcasts.showBlank(),pm.broadcasts.fetch(),a){new Date(a);pm.broadcasts.setLastUpdateTime(b)}else pm.broadcasts.setLastUpdateTime(b);$("#broadcasts-count").on("click",function(){tracker.sendEvent("broadcast","view"),pm.broadcasts.markAllAsRead()})},showBlank:function(){var a=$("#broadcasts-count");a.removeClass(),a.addClass("no-new-broadcasts"),a.html("0")},fetch:function(){var a=pm.webUrl+"/broadcasts";$.get(a,function(a){pm.broadcasts.setBroadcasts(a.broadcasts),pm.broadcasts.renderBroadcasts()})},setLastUpdateTime:function(a){localStorage.broadcast_last_update_time=a.toUTCString()},setBroadcasts:function(a){var b;b="broadcasts"in localStorage?JSON.parse(localStorage.broadcasts):[];var c,d,e;if(0==b.length){for(d=a.length,c=0;d>c;c++)a[c].status="unread";e=a.length,localStorage.broadcasts=JSON.stringify(a)}else{d=a.length;var f=[];for(c=0;d>c;c++){var g=a[c],h=_.find(b,function(a){return a.id===g.id});h||(g.status="unread",f.push(g))}e=f.length,b=_.union(f,b),localStorage.broadcasts=JSON.stringify(b)}var i=$("#broadcasts-count");i.html(e),i.removeClass(),e>0?i.addClass("new-broadcasts"):i.addClass("no-new-broadcasts")},markAllAsRead:function(){var a=$("#broadcasts-count");a.removeClass(),a.addClass("no-new-broadcasts"),a.html("0");for(var b=JSON.parse(localStorage.broadcasts),c=b.length,d=0;c>d;d++)b[d].status="read";localStorage.broadcasts=JSON.stringify(b),pm.broadcasts.renderBroadcasts()},renderBroadcasts:function(){var a=JSON.parse(localStorage.broadcasts);$("#broadcasts .dropdown-menu").html(""),$("#broadcasts .dropdown-menu").append(Handlebars.templates.broadcasts({items:a}))}},pm.collections={areLoaded:!1,items:[],init:function(){this.addCollectionListeners()},addCollectionListeners:function(){var a=$("#collection-items");a.on("mouseenter",".sidebar-collection .sidebar-collection-head",function(){var a=jQuery(".collection-head-actions",this);a.css("display","block")}),a.on("mouseleave",".sidebar-collection .sidebar-collection-head",function(){var a=jQuery(".collection-head-actions",this);a.css("display","none")}),a.on("click",".sidebar-collection-head-name",function(){var a=$(this).attr("data-id");pm.collections.toggleRequestList(a)}),a.on("click",".collection-head-actions .label",function(){var a=$(this).parent().parent().parent().attr("data-id");pm.collections.toggleRequestList(a)}),a.on("click",".request-actions-load",function(){var a=$(this).attr("data-id");pm.collections.getCollectionRequest(a)}),a.on("click",".request-actions-delete",function(){var a=$(this).attr("data-id");pm.indexedDB.getCollectionRequest(a,function(b){$("#modal-delete-collection-request-yes").attr("data-id",a),$("#modal-delete-collection-request-name").html(b.name),$("#modal-delete-collection-request").modal("show")})}),a.on("click",".request-actions-edit",function(){var a=$(this).attr("data-id");$("#form-edit-collection-request .collection-request-id").val(a),pm.indexedDB.getCollectionRequest(a,function(a){$("#form-edit-collection-request .collection-request-name").val(a.name),$("#form-edit-collection-request .collection-request-description").val(a.description),$("#modal-edit-collection-request").modal("show")})}),a.on("click",".collection-actions-edit",function(){var a=$(this).attr("data-id");pm.indexedDB.getCollection(a,function(a){$("#form-edit-collection .collection-id").val(a.id),$("#form-edit-collection .collection-name").val(a.name),$("#modal-edit-collection").modal("show")})}),a.on("click",".collection-actions-delete",function(){var a=$(this).attr("data-id");$(this).attr("data-name");pm.indexedDB.getCollection(a,function(b){$("#modal-delete-collection-yes").attr("data-id",a),$("#modal-delete-collection-name").html(b.name)})}),$("#modal-delete-collection-yes").on("click",function(){var a=$(this).attr("data-id");pm.collections.deleteCollection(a)}),$("#modal-delete-collection-request-yes").on("click",function(){var a=$(this).attr("data-id");pm.collections.deleteCollectionRequest(a)}),$("#import-collection-url-submit").on("click",function(){var a=$("#import-collection-url-input").val();pm.collections.importCollectionFromUrl(a)}),a.on("click",".collection-actions-download",function(){var a=$(this).attr("data-id");$("#modal-share-collection").modal("show"),$("#share-collection-get-link").attr("data-collection-id",a),$("#share-collection-download").attr("data-collection-id",a),$("#share-collection-link").css("display","none")}),$("#share-collection-get-link").on("click",function(){var a=$(this).attr("data-collection-id");pm.collections.uploadCollection(a,function(a){$("#share-collection-link").css("display","block"),$("#share-collection-link").html(a)})}),$("#share-collection-download").on("click",function(){var a=$(this).attr("data-collection-id");pm.collections.saveCollection(a)}),$("#request-samples").on("click",".sample-response-name",function(){var a=$(this).attr("data-id");pm.collections.loadResponseInEditor(a)}),$("#request-samples").on("click",".sample-response-delete",function(){var a=$(this).attr("data-id");pm.collections.removeSampleResponse(a)});var b=document.getElementById("import-collection-dropzone");b.addEventListener("dragover",function(a){a.stopPropagation(),a.preventDefault(),a.dataTransfer.dropEffect="copy"},!1),b.addEventListener("drop",function(a){a.stopPropagation(),a.preventDefault();var b=a.dataTransfer.files;pm.collections.importCollections(b)},!1),$("#collection-files-input").on("change",function(a){var b=a.target.files;pm.collections.importCollections(b),$("#collection-files-input").val("")})},getCollectionData:function(a,b){pm.indexedDB.getCollection(a,function(a){var c=a;pm.indexedDB.getAllRequestsInCollection(c,function(a,c){for(var d=[],e=0,f=c.length;f>e;e++)d.push(c[e].id);a.requests=c;var g=a.name+".json",h="application/json",i=JSON.stringify(a);b(g,h,i)})})},saveCollection:function(a){pm.collections.getCollectionData(a,function(a,b,c){pm.filesystem.saveAndOpenFile(a,c,b,function(){})})},uploadCollection:function(a,b){pm.collections.getCollectionData(a,function(a,c,d){var e=pm.webUrl+"/collections";$.ajax({type:"POST",url:e,data:d,success:function(a){var c=a.link;b(c)}})})},importCollectionData:function(a){pm.indexedDB.addCollection(a,function(b){var c={name:a.name,action:"added"};$(".modal-import-alerts").append(Handlebars.templates.message_collection_added(c));var d=[],e=!1;"order"in a&&(e=!0);for(var f=0;f<a.requests.length;f++){var g=a.requests[f];g.collectionId=a.id,g.hasOwnProperty("rawModeData")&&(g.data=g.rawModeData);var h=guid();if(e){var i=g.id,j=_.indexOf(a.order,i);a.order[j]=h}if(g.id=h,"responses"in g){var k,l;for(k=0,l=g.responses.length;l>k;k++)g.responses[k].id=guid(),g.responses[k].collectionRequestId=h}pm.indexedDB.addCollectionRequest(g,function(a){}),d.push(g)}pm.indexedDB.updateCollection(a,function(){}),a.requests=d,pm.collections.render(a)})},importCollections:function(a){for(var b,c=0;b=a[c];c++){var d=new FileReader;d.onload=function(a){return function(a){var b=a.currentTarget.result,c=JSON.parse(b);c.id=guid(),pm.collections.importCollectionData(c)}}(b),d.readAsText(b)}},importCollectionFromUrl:function(a){$.get(a,function(a){var b=a;b.id=guid(),pm.collections.importCollectionData(b)})},getCollectionRequest:function(a){$(".sidebar-collection-request").removeClass("sidebar-collection-request-active"),$("#sidebar-request-"+a).addClass("sidebar-collection-request-active"),pm.indexedDB.getCollectionRequest(a,function(b){pm.request.isFromCollection=!0,pm.request.collectionRequestId=a,pm.request.loadRequestInEditor(b,!0)})},loadResponseInEditor:function(a){var b=pm.request.responses,c=find(b,function(b,c,d){return b.id===a}),d=b[c];pm.request.loadRequestInEditor(d.request,!1,!0),pm.request.response.render(d)},removeSampleResponse:function(a){var b=pm.request.responses,c=find(b,function(b,c,d){return b.id===a}),d=b[c];b.splice(c,1),pm.indexedDB.getCollectionRequest(d.collectionRequestId,function(a){a.responses=b,pm.indexedDB.updateCollectionRequest(a,function(){$('#request-samples table tr[data-id="'+d.id+'"]').remove()})})},openCollection:function(a){var b="#collection-requests-"+a;"none"===$(b).css("display")&&$(b).slideDown(100,function(){pm.layout.refreshScrollPanes()})},toggleRequestList:function(a){var b="#collection-requests-"+a;"none"===$(b).css("display")?$(b).slideDown(100,function(){pm.layout.refreshScrollPanes()}):$(b).slideUp(100,function(){pm.layout.refreshScrollPanes()})},addCollection:function(){var a=$("#new-collection-blank").val(),b=new Collection;a&&(b.id=guid(),b.name=a,pm.indexedDB.addCollection(b,function(a){pm.collections.render(a)}),$("#new-collection-blank").val("")),$("#modal-new-collection").modal("hide")},updateCollectionFromCurrentRequest:function(){var a=$("#url").val(),b=new CollectionRequest;b.id=pm.request.collectionRequestId,b.headers=pm.request.getPackedHeaders(),b.url=a,b.method=pm.request.method,b.data=pm.request.body.getData(!0),b.dataMode=pm.request.dataMode,b.version=2,b.time=(new Date).getTime(),pm.indexedDB.getCollectionRequest(b.id,function(a){b.name=a.name,b.description=a.description,b.collectionId=a.collectionId,$("#sidebar-request-"+a.id+" .request .label").removeClass("label-method-"+a.method),pm.indexedDB.updateCollectionRequest(b,function(a){var b;void 0==a.name&&(a.name=a.url),b=limitStringLineWidth(a.name,43),$("#sidebar-request-"+a.id+" .request .request-name").html(b),$("#sidebar-request-"+a.id+" .request .label").html(a.method),$("#sidebar-request-"+a.id+" .request .label").addClass("label-method-"+a.method),noty({type:"success",text:"Saved request",layout:"topRight",timeout:750})})})},addRequestToCollection:function(){$(".sidebar-collection-request").removeClass("sidebar-collection-request-active");var a=$("#select-collection").val(),b=$("#new-collection").val(),c=$("#new-request-name").val(),d=$("#new-request-description").val(),e=$("#url").val();""===c&&(c=e);var f=new Collection,g=new CollectionRequest;g.id=guid(),g.headers=pm.request.getPackedHeaders(),g.url=e,g.method=pm.request.method,g.data=pm.request.body.getData(!0),g.dataMode=pm.request.dataMode,g.name=c,g.description=d,g.time=(new Date).getTime(),g.version=2,g.responses=pm.request.responses,b?(f.id=guid(),f.name=b,pm.indexedDB.addCollection(f,function(a){$("#sidebar-section-collections .empty-message").css("display","none"),$("#new-collection").val(""),g.collectionId=a.id,$("#select-collection").append(Handlebars.templates.item_collection_selector_list(a)),$("#collection-items").append(Handlebars.templates.item_collection_sidebar_head(a)),$('a[rel="tooltip"]').tooltip(),pm.layout.refreshScrollPanes(),pm.indexedDB.addCollectionRequest(g,function(a){var b="#collection-requests-"+a.collectionId;$("#sidebar-request-"+a.id).addClass("sidebar-collection-request-active"),pm.urlCache.addUrl(a.url),"undefined"==typeof a.name&&(a.name=a.url),a.name=limitStringLineWidth(a.name,43),$(b).append(Handlebars.templates.item_collection_sidebar_request(a)),pm.layout.refreshScrollPanes(),pm.request.isFromCollection=!0,pm.request.collectionRequestId=g.id,$("#update-request-in-collection").css("display","inline-block"),pm.collections.openCollection(g.collectionId)})})):(f.id=a,g.collectionId=f.id,pm.indexedDB.addCollectionRequest(g,function(a){var b="#collection-requests-"+a.collectionId;pm.urlCache.addUrl(a.url),"undefined"==typeof a.name&&(a.name=a.url),a.name=limitStringLineWidth(a.name,43),$(b).append(Handlebars.templates.item_collection_sidebar_request(a)),$("#sidebar-request-"+a.id).addClass("sidebar-collection-request-active"),pm.layout.refreshScrollPanes(),pm.request.isFromCollection=!0,pm.request.collectionRequestId=g.id,$("#update-request-in-collection").css("display","inline-block"),pm.collections.openCollection(g.collectionId),pm.indexedDB.getCollection(f.id,function(a){"order"in a&&(a.order.push(g.id),pm.indexedDB.updateCollection(a,function(){}))})})),pm.layout.sidebar.select("collections"),$("#request-meta").css("display","block"),$("#request-name").css("display","block"),$("#request-description").css("display","block"),$("#request-name").html(c),$("#request-description").html(d),$('#sidebar-selectors a[data-id="collections"]').tab("show")},getAllCollections:function(){$("#collection-items").html(""),$("#select-collection").html("<option>Select</option>"),pm.indexedDB.getCollections(function(a){pm.collections.items=a,pm.collections.items.sort(sortAlphabetical);var b=a.length;if(0===b)$("#sidebar-section-collections").append(Handlebars.templates.message_no_collection({}));else for(var c=0;b>c;c++){var d=a[c];pm.indexedDB.getAllRequestsInCollection(d,function(a,b){a.requests=b,pm.collections.render(a)})}pm.collections.areLoaded=!0,pm.layout.refreshScrollPanes()})},handleRequestDropOnCollection:function(a,b){var c=b.draggable.context.id,d=$("#"+c+" .request").attr("data-id"),e=$($(a.target).find(".sidebar-collection-head-name")[0]).attr("data-id");pm.indexedDB.getCollection(e,function(a){pm.indexedDB.getCollectionRequest(d,function(b){e!=b.collectionId&&(pm.collections.deleteCollectionRequest(d),b.id=guid(),b.collectionId=e,pm.indexedDB.addCollectionRequest(b,function(c){var d="#collection-requests-"+c.collectionId;pm.urlCache.addUrl(c.url),"undefined"==typeof c.name&&(c.name=c.url),c.name=limitStringLineWidth(c.name,43),$(d).append(Handlebars.templates.item_collection_sidebar_request(c)),pm.layout.refreshScrollPanes(),$("#update-request-in-collection").css("display","inline-block"),pm.collections.openCollection(b.collectionId),$("#collection-"+b.collectionId+" .sidebar-collection-head").droppable({accept:".sidebar-collection-request",hoverClass:"ui-state-hover",drop:pm.collections.handleRequestDropOnCollection}),pm.indexedDB.getCollection(a.id,function(a){"order"in a&&(a.order.push(b.id),pm.indexedDB.updateCollection(a,function(){}))})}))})})},render:function(a){$("#sidebar-section-collections .empty-message").css("display","none");var b=$("#collection-"+a.id);if(b&&b.remove(),$("#select-collection").append(Handlebars.templates.item_collection_selector_list(a)),$("#collection-items").append(Handlebars.templates.item_collection_sidebar_head(a)),$('a[rel="tooltip"]').tooltip(),$("#collection-"+a.id+" .sidebar-collection-head").droppable({accept:".sidebar-collection-request",hoverClass:"ui-state-hover",drop:pm.collections.handleRequestDropOnCollection}),"requests"in a){var c,d=a.id,e=a.requests,f="#collection-requests-"+d,g=e.length;if(g>0){for(var h=0;g>h;h++)pm.urlCache.addUrl(e[h].url),"undefined"==typeof e[h].name&&(e[h].name=e[h].url),e[h].name=limitStringLineWidth(e[h].name,40),c="#sidebar-request-"+e[h].id,$(c).draggable({});if("order"in a){if(a.order.length==e.length){for(var i=[],j=0,k=a.order.length;k>j;j++){var l=_.find(e,function(b){return b.id==a.order[j]});i.push(l)}e=i}}else e.sort(sortAlphabetical);$(f).append(Handlebars.templates.collection_sidebar({items:e})),$(f).sortable({update:function(a,b){for(var c=$(a.target).parents(".sidebar-collection-requests"),d=$(a.target).parents(".sidebar-collection"),e=$(d).attr("data-id"),f=($(c.context).attr("id"),$(c.context).children("li")),g=f.length,h=[],i=0;g>i;i++){var j=$(f[i]).attr("id"),k=$("#"+j+" .request").attr("data-id");h.push(k)}pm.indexedDB.getCollection(e,function(a){a.order=h,pm.indexedDB.updateCollection(a,function(a){})})}})}}pm.layout.refreshScrollPanes()},deleteCollectionRequest:function(a){pm.indexedDB.getCollectionRequest(a,function(b){pm.indexedDB.deleteCollectionRequest(a,function(){pm.layout.sidebar.removeRequestFromHistory(a),pm.indexedDB.getCollection(b.collectionId,function(b){var c=b.order,d=c.indexOf(a);c.splice(d,1),b.order=c,pm.indexedDB.updateCollection(b,function(a){})})})})},updateCollectionMeta:function(a,b){pm.indexedDB.getCollection(a,function(a){a.name=b,pm.indexedDB.updateCollection(a,function(a){$("#collection-"+a.id+" .sidebar-collection-head-name").html(a.name),$('#select-collection option[value="'+a.id+'"]').html(a.name)})})},updateCollectionRequestMeta:function(a,b,c){pm.indexedDB.getCollectionRequest(a,function(a){a.name=b,a.description=c,pm.indexedDB.updateCollectionRequest(a,function(b){var c;c=void 0!=a.name?limitStringLineWidth(a.name,43):limitStringLineWidth(a.url,43),$("#sidebar-request-"+a.id+" .request .request-name").html(c),pm.request.collectionRequestId===a.id&&($("#request-name").html(a.name),$("#request-description").html(a.description)),$("#modal-edit-collection-request").modal("hide")})})},deleteCollection:function(a){pm.indexedDB.deleteCollection(a,function(){pm.layout.sidebar.removeCollection(a);var b='#select-collection option[value="'+a+'"]';$(b).remove()})},saveResponseAsSample:function(a){pm.indexedDB.getCollectionRequest(a.collectionRequestId,function(b){"responses"in b&&void 0!==b.responses?b.responses.push(a):b.responses=[a],pm.request.responses=b.responses,pm.indexedDB.updateCollectionRequest(b,function(){noty({type:"success",text:"Saved response",layout:"topRight",timeout:750}),$("#request-samples").css("display","block"),$("#request-samples table").append(Handlebars.templates.item_sample_response(a))})})}},pm.editor={mode:"html",codeMirror:null,charCount:0,init:function(){CodeMirror.defineMode("links",function(a,b){console.log("Defining mode");var c={startState:function(){return{link:""}},token:function(a,b){if(a.eatSpace())return null;var c,d=a.string.substr(a.start);if(c=d.match(/https?:\/\/[^\\'"\n\t\s]*(?=[<"'\n\t\s])/,!1)){var e=d.match(/.*(?=https?:)/,!0);if(e&&e[0].length>0)return a.next(),null;var f=c[0];if(f!=b.link){b.link=c[0];for(var g=0;g<b.link.length;g++)a.next();return b.link="","link"}return a.skipToEnd(),null}return a.skipToEnd(),null}};return CodeMirror.overlayParser(CodeMirror.getMode(a,b.backdrop||pm.editor.mode),c)})},toggleLineWrapping:function(){var a=pm.editor.codeMirror.getOption("lineWrapping");a===!0?($("#response-body-line-wrapping").removeClass("active"),a=!1,pm.editor.codeMirror.setOption("lineWrapping",!1)):($("#response-body-line-wrapping").addClass("active"),a=!0,pm.editor.codeMirror.setOption("lineWrapping",!0)),pm.settings.set("lineWrapping",a),pm.editor.codeMirror.refresh()}},pm.envManager={environments:[],globals:{},selectedEnv:null,selectedEnvironmentId:"",quicklook:{init:function(){pm.envManager.quicklook.refreshEnvironment(pm.envManager.selectedEnv),pm.envManager.quicklook.refreshGlobals(pm.envManager.globals)},removeEnvironmentData:function(){$("#environment-quicklook-environments h6").html("No environment"),$("#environment-quicklook-environments ul").html("")},refreshEnvironment:function(a){a&&($("#environment-quicklook-environments h6").html(a.name),$("#environment-quicklook-environments ul").html(""),$("#environment-quicklook-environments ul").append(Handlebars.templates.environment_quicklook({items:a.values})))},refreshGlobals:function(a){a&&($("#environment-quicklook-globals ul").html(""),$("#environment-quicklook-globals ul").append(Handlebars.templates.environment_quicklook({items:a})))},toggleDisplay:function(){var a=$("#environment-quicklook-content").css("display");"none"==a?$("#environment-quicklook-content").css("display","block"):$("#environment-quicklook-content").css("display","none")}},init:function(){pm.envManager.initGlobals(),$("#environment-list").append(Handlebars.templates.environment_list({items:this.environments})),$("#environments-list").on("click",".environment-action-delete",function(){var a=$(this).attr("data-id");$('a[rel="tooltip"]').tooltip("hide"),pm.envManager.deleteEnvironment(a)}),$("#environments-list").on("click",".environment-action-edit",function(){var a=$(this).attr("data-id");pm.envManager.showEditor(a)}),$("#environments-list").on("click",".environment-action-duplicate",function(){var a=$(this).attr("data-id");pm.envManager.duplicateEnvironment(a)}),$("#environments-list").on("click",".environment-action-download",function(){var a=$(this).attr("data-id");pm.envManager.downloadEnvironment(a)}),$(".environment-action-back").on("click",function(){pm.envManager.showSelector()}),$("#environment-selector").on("click",".environment-list-item",function(){var a=$(this).attr("data-id"),b=pm.envManager.getEnvironmentFromId(a);pm.envManager.selectedEnv=b,pm.settings.set("selectedEnvironmentId",b.id),pm.envManager.quicklook.refreshEnvironment(b),$("#environment-selector .environment-list-item-selected").html(b.name)}),$("#environment-selector").on("click",".environment-list-item-noenvironment",function(){pm.envManager.selectedEnv=null,pm.settings.set("selectedEnvironmentId",""),pm.envManager.quicklook.removeEnvironmentData(),$("#environment-selector .environment-list-item-selected").html("No environment")}),$("#environment-quicklook").on("mouseenter",function(){$("#environment-quicklook-content").css("display","block")}),$("#environment-quicklook").on("mouseleave",function(){$("#environment-quicklook-content").css("display","none")}),$("#environment-files-input").on("change",function(a){var b=a.target.files;pm.envManager.importEnvironments(b),$("#environment-files-input").val("")}),$(".environments-actions-add").on("click",function(){pm.envManager.showEditor()}),$(".environments-actions-import").on("click",function(){pm.envManager.showImporter()}),$(".environments-actions-manage-globals").on("click",function(){pm.envManager.showGlobals()}),$(".environments-actions-add-submit").on("click",function(){var a=$("#environment-editor-id").val();"0"===a?pm.envManager.addEnvironment():pm.envManager.updateEnvironment(),$("#environment-editor-name").val(""),$("#environment-keyvaleditor").keyvalueeditor("reset",[])}),$(".environments-actions-add-back").on("click",function(){pm.envManager.saveGlobals(),pm.envManager.showSelector(),$("#environment-editor-name").val(""),$("#environment-keyvaleditor").keyvalueeditor("reset",[])}),$("#environments-list-help-toggle").on("click",function(){var a=$("#environments-list-help-detail").css("display");"none"===a?($("#environments-list-help-detail").css("display","inline"),$(this).html("Hide")):($("#environments-list-help-detail").css("display","none"),$(this).html("Tell me more"))});var a={placeHolderKey:"Key",placeHolderValue:"Value",deleteButton:'<img class="deleteButton" src="img/delete.png">'};$("#environment-keyvaleditor").keyvalueeditor("init",a),$("#globals-keyvaleditor").keyvalueeditor("init",a),$("#globals-keyvaleditor").keyvalueeditor("reset",pm.envManager.globals),pm.envManager.quicklook.init()},getEnvironmentFromId:function(a){for(var b=pm.envManager.environments,c=b.length,d=0;c>d;d++){var e=b[d];if(a===e.id)return e}return!1},containsVariable:function(a,b){var c,d=pm.settings.get("variableDelimiter"),e=d.substring(0,2),f=d.substring(d.length-2),g=e+"[^\r\n]*"+f,h=new RegExp(g,"g"),i=a.match(h),j=b.length;if(null===i)return!1;for(var k=0;j>k;k++)if(c=e+b[k].key+f,_.indexOf(i,c)>=0)return!0;return!1},processString:function(a,b){for(var c,d,e=b.length,f=a,g=pm.settings.get("variableDelimiter"),h=g.substring(0,2),i=g.substring(g.length-2),j=0;e>j;j++)c=h+b[j].key+i,d=new RegExp(c,"g"),f=f.replace(c,b[j].value);var k=pm.envManager.globals;for(e=k.length,j=0;e>j;j++)c=h+k[j].key+i,d=new RegExp(c,"g"),f=f.replace(c,k[j].value);return pm.envManager.containsVariable(f,b)?f=pm.envManager.processString(f,b):f},convertString:function(a){var b=pm.envManager.selectedEnv,c=[];return null!==b&&(c=b.values),pm.envManager.processString(a,c)},getCurrentValue:function(a){var b=pm.envManager.selectedEnv,c=[];return null!==b&&(c=b.values),pm.envManager.processString(a,c)},getAllEnvironments:function(){pm.indexedDB.environments.getAllEnvironments(function(a){a.sort(sortAlphabetical),$("#environment-selector .dropdown-menu").html(""),$("#environments-list tbody").html(""),pm.envManager.environments=a,$("#environment-selector .dropdown-menu").append(Handlebars.templates.environment_selector({items:a})),$("#environments-list tbody").append(Handlebars.templates.environment_list({items:a})),$("#environment-selector .dropdown-menu").append(Handlebars.templates.environment_selector_actions());var b=pm.settings.get("selectedEnvironmentId"),c=pm.envManager.getEnvironmentFromId(b);c?(pm.envManager.selectedEnv=c,pm.envManager.quicklook.refreshEnvironment(c),$("#environment-selector .environment-list-item-selected").html(c.name)):(pm.envManager.selectedEnv=null,$("#environment-selector .environment-list-item-selected").html("No environment"))})},initGlobals:function(){if("globals"in localStorage){var a=localStorage.globals;pm.envManager.globals=JSON.parse(a)}else pm.envManager.globals=[]},saveGlobals:function(){var a=$("#globals-keyvaleditor").keyvalueeditor("getValues");pm.envManager.globals=a,pm.envManager.quicklook.refreshGlobals(a),localStorage.globals=JSON.stringify(a)},showSelector:function(){$("#environments-list-wrapper").css("display","block"),$("#environment-editor").css("display","none"),$("#environment-importer").css("display","none"),$("#globals-editor").css("display","none"),$(".environments-actions-add-submit").css("display","inline"),$("#modal-environments .modal-footer").css("display","none")},showEditor:function(a){if(a){var b=pm.envManager.getEnvironmentFromId(a);$("#environment-editor-name").val(b.name),$("#environment-editor-id").val(a),$("#environment-keyvaleditor").keyvalueeditor("reset",b.values)}else $("#environment-editor-id").val(0);$("#environments-list-wrapper").css("display","none"),$("#environment-editor").css("display","block"),$("#globals-editor").css("display","none"),$("#modal-environments .modal-footer").css("display","block")},showImporter:function(){$("#environments-list-wrapper").css("display","none"),$("#environment-editor").css("display","none"),$("#globals-editor").css("display","none"),$("#environment-importer").css("display","block"),$(".environments-actions-add-submit").css("display","none"),$("#modal-environments .modal-footer").css("display","block")},showGlobals:function(){$("#environments-list-wrapper").css("display","none"),$("#environment-editor").css("display","none"),$("#globals-editor").css("display","block"),$("#environment-importer").css("display","none"),$(".environments-actions-add-submit").css("display","none"),$("#modal-environments .modal-footer").css("display","block")},addEnvironment:function(){var a=$("#environment-editor-name").val(),b=$("#environment-keyvaleditor").keyvalueeditor("getValues"),c={id:guid(),name:a,values:b,timestamp:(new Date).getTime()};pm.indexedDB.environments.addEnvironment(c,function(){pm.envManager.getAllEnvironments(),pm.envManager.showSelector()})},updateEnvironment:function(){var a=$("#environment-editor-id").val(),b=$("#environment-editor-name").val(),c=$("#environment-keyvaleditor").keyvalueeditor("getValues"),d={id:a,name:b,values:c,timestamp:(new Date).getTime()};pm.indexedDB.environments.updateEnvironment(d,function(){pm.envManager.getAllEnvironments(),pm.envManager.showSelector()})},deleteEnvironment:function(a){pm.indexedDB.environments.deleteEnvironment(a,function(){pm.envManager.getAllEnvironments(),pm.envManager.showSelector()})},duplicateEnvironment:function(a){var b=pm.envManager.getEnvironmentFromId(a);b.name=b.name+" copy",b.id=guid(),pm.indexedDB.environments.addEnvironment(b,function(){({name:b.name,action:"added"});pm.envManager.getAllEnvironments()})},downloadEnvironment:function(a){var b=pm.envManager.getEnvironmentFromId(a),c=b.name+"-environment.json",d="application/json",e=JSON.stringify(b);pm.filesystem.saveAndOpenFile(c,e,d,function(){})},importEnvironments:function(a){for(var b,c=0;b=a[c];c++){var d=new FileReader;d.onload=function(a){return function(a){var b=a.currentTarget.result,c=JSON.parse(b);pm.indexedDB.environments.addEnvironment(c,function(){var a={name:c.name,action:"added"};$("#environment-importer-confirmations").append(Handlebars.templates.message_environment_added(a)),pm.envManager.getAllEnvironments()})}}(b),d.readAsText(b)}}},pm.filesystem={fs:{},onInitFs:function(a){pm.filesystem.fs=a},errorHandler:function(a){var b="";switch(a.code){case FileError.QUOTA_EXCEEDED_ERR:b="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:b="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:b="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:b="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:b="INVALID_STATE_ERR";break;default:b="Unknown Error"}console.log("Error: "+b)},init:function(){window.requestFileSystem(window.TEMPORARY,5242880,this.onInitFs,this.errorHandler)},removeFileIfExists:function(a,b){pm.filesystem.fs.root.getFile(a,{create:!1},function(a){a.remove(function(){b()},function(){b()})},function(){b()})},renderResponsePreview:function(a,b,c,d){a=encodeURI(a),a=a.replace("/","_"),pm.filesystem.removeFileIfExists(a,function(){pm.filesystem.fs.root.getFile(a,{create:!0},function(a){a.createWriter(function(e){e.onwriteend=function(b){var c={url:a.toURL()};d(c.url)},e.onerror=function(a){d(!1)};var f;f="pdf"==c?new Blob([b],{type:"application/pdf"}):new Blob([b],{type:"text/plain"}),e.write(f)},pm.filesystem.errorHandler)},pm.filesystem.errorHandler)})},saveAndOpenFile:function(a,b,c,d){a=encodeURI(a),a=a.replace("/","_"),pm.filesystem.removeFileIfExists(a,function(){pm.filesystem.fs.root.getFile(a,{create:!0},function(a){a.createWriter(function(e){e.onwriteend=function(b){var c={url:a.toURL()};"undefined"!=typeof chrome&&chrome.tabs.create(c,function(a){}),d()},e.onerror=function(a){d()};var f;f="pdf"==c?new Blob([b],{type:"application/pdf"}):new Blob([b],{type:"text/plain"}),e.write(f)},pm.filesystem.errorHandler)},pm.filesystem.errorHandler)})}},pm.headerPresets={presets:[],presetsForAutoComplete:[],init:function(){pm.headerPresets.loadPresets();var a={placeHolderKey:"Key",placeHolderValue:"Value",deleteButton:'<img class="deleteButton" src="img/delete.png">'};$("#header-presets-keyvaleditor").keyvalueeditor("init",a),$("#headers-keyvaleditor-actions-manage-presets").on("click",function(){pm.headerPresets.showManager()}),$(".header-presets-actions-add").on("click",function(){pm.headerPresets.showEditor()}),$(".header-presets-actions-back").on("click",function(){pm.headerPresets.showList();
}),$(".header-presets-actions-submit").on("click",function(){var a=$("#header-presets-editor-id").val();if("0"===a)pm.headerPresets.addHeaderPreset();else{var b=$("#header-presets-editor-name").val(),c=$("#header-presets-keyvaleditor").keyvalueeditor("getValues");pm.headerPresets.editHeaderPreset(a,b,c)}pm.headerPresets.showList()}),$("#header-presets-list").on("click",".header-preset-action-edit",function(){var a=$(this).attr("data-id"),b=pm.headerPresets.getHeaderPreset(a);$("#header-presets-editor-name").val(b.name),$("#header-presets-editor-id").val(b.id),$("#header-presets-keyvaleditor").keyvalueeditor("reset",b.headers),pm.headerPresets.showEditor()}),$("#header-presets-list").on("click",".header-preset-action-delete",function(){var a=$(this).attr("data-id");pm.headerPresets.deleteHeaderPreset(a)})},loadPresets:function(){pm.indexedDB.headerPresets.getAllHeaderPresets(function(a){pm.headerPresets.presets=a,pm.headerPresets.refreshAutoCompleteList(),$("#header-presets-list tbody").html(""),$("#header-presets-list tbody").append(Handlebars.templates.header_preset_list({items:a}))})},showManager:function(){$("#modal-header-presets").modal("show")},showList:function(){$("#header-presets-list-wrapper").css("display","block"),$("#header-presets-editor").css("display","none"),$("#header-presets-editor-name").attr("value",""),$("#header-presets-editor-id").attr("value",0),$("#header-presets-keyvaleditor").keyvalueeditor("reset",[]),$("#modal-header-presets .modal-footer").css("display","none")},showEditor:function(){$("#modal-header-presets .modal-footer").css("display","block"),$("#header-presets-list-wrapper").css("display","none"),$("#header-presets-editor").css("display","block")},getHeaderPreset:function(a){for(var b=0,c=pm.headerPresets.presets.length;c>b&&pm.headerPresets.presets[b].id!==a;b++);var d=pm.headerPresets.presets[b];return d},addHeaderPreset:function(){var a=$("#header-presets-editor-name").val(),b=$("#header-presets-keyvaleditor").keyvalueeditor("getValues"),c=guid(),d={id:c,name:a,headers:b,timestamp:(new Date).getTime()};pm.indexedDB.headerPresets.addHeaderPreset(d,function(){pm.headerPresets.loadPresets()})},editHeaderPreset:function(a,b,c){pm.indexedDB.headerPresets.getHeaderPreset(a,function(d){var e={id:a,name:b,headers:c,timestamp:d.timestamp};pm.indexedDB.headerPresets.updateHeaderPreset(e,function(){pm.headerPresets.loadPresets()})})},deleteHeaderPreset:function(a){pm.indexedDB.headerPresets.deleteHeaderPreset(a,function(){pm.headerPresets.loadPresets()})},getPresetsForAutoComplete:function(){for(var a=[],b=0,c=pm.headerPresets.presets.length;c>b;b++){var d=pm.headerPresets.presets[b],e={id:d.id,type:"preset",label:d.name,category:"Header presets"};a.push(e)}return a},refreshAutoCompleteList:function(){var a=pm.headerPresets.getPresetsForAutoComplete();pm.headerPresets.presetsForAutoComplete=_.union(a,chromeHeaders)}},pm.helpers={activeHelper:"normal",init:function(){$("#request-types .request-helper-tabs li").on("click",function(){$("#request-types .request-helper-tabs li").removeClass("active"),$(this).addClass("active");var a=$(this).attr("data-id");pm.helpers.showRequestHelper(a)}),$(".request-helper-submit").on("click",function(){var a=$(this).attr("data-type");$("#request-helpers").css("display","none"),pm.helpers.processRequestHelper(a)}),pm.helpers.oAuth1.init()},processRequestHelper:function(a){return"basic"===a?this.basic.process():"oAuth1"===a?this.oAuth1.process():"digest"===a&&this.digest.process(),!1},showRequestHelper:function(a){return pm.helpers.activeHelper=a.toLowerCase(),$("#request-types ul li").removeClass("active"),$("#request-types ul li[data-id="+a+"]").addClass("active"),"normal"!==a?$("#request-helpers").css("display","block"):$("#request-helpers").css("display","none"),"oauth1"===a.toLowerCase()&&this.oAuth1.generateHelper(),$(".request-helpers").css("display","none"),$("#request-helper-"+a).css("display","block"),!1},basic:{process:function(){var a=pm.request.headers,b="Authorization",c=findPosition(a,"key",b),d=$("#request-helper-basicAuth-username").val(),e=$("#request-helper-basicAuth-password").val();d=pm.envManager.convertString(d),e=pm.envManager.convertString(e);var f=d+":"+e,g="Basic "+btoa(f);c>=0?a[c]={key:b,name:b,value:g}:a.push({key:b,name:b,value:g}),pm.request.headers=a,$("#headers-keyvaleditor").keyvalueeditor("reset",a),pm.request.openHeaderEditor()}},digest:{getHeader:function(){var a=pm.envManager.getCurrentValue($("#request-helper-digestAuth-realm").val()),b=pm.envManager.getCurrentValue($("#request-helper-digestAuth-username").val()),c=pm.envManager.getCurrentValue($("#request-helper-digestAuth-realm").val()),d=pm.envManager.getCurrentValue($("#request-helper-digestAuth-password").val()),e=pm.request.method.toUpperCase(),f=pm.envManager.getCurrentValue($("#request-helper-digestAuth-nonce").val()),g=pm.envManager.getCurrentValue($("#request-helper-digestAuth-nonceCount").val()),h=pm.envManager.getCurrentValue($("#request-helper-digestAuth-clientNonce").val()),i=pm.envManager.getCurrentValue($("#request-helper-digestAuth-opaque").val()),j=pm.envManager.getCurrentValue($("#request-helper-digestAuth-qop").val()),k=pm.request.getRequestBodyPreview(),l=pm.request.processUrl($("#url").val()),m=pm.request.splitUrlIntoHostAndPath(l),n=m.path;console.log(a),console.log(b),console.log(c),console.log(d),console.log(e),console.log(f),console.log(g),console.log(h),console.log(i),console.log(j),console.log(k);var o;if("MD5-sess"===a){var p=CryptoJS.MD5(b+":"+c+":"+d);o=p+":"+f+":"+h}else console.log(a,"MD5"),o=b+":"+c+":"+d,console.log(o);var q;"auth-int"===j?q=e+":"+n+":"+k:(q=e+":"+n,console.log(j,q));var r,s=CryptoJS.MD5(o),t=CryptoJS.MD5(q);"auth-int"===j||"auth"===j?(r=CryptoJS.MD5(s+":"+f+":"+g+":"+h+":"+j+":"+t),console.log(r)):r=CryptoJS.MD5(s+":"+f+":"+t);var u=" ";return u+='username="'+b+'", ',u+='realm="'+c+'", ',u+='nonce="'+f+'", ',u+='uri="'+n+'", ',("auth"===j||"auth-int"===j)&&(u+="qop="+j+", "),("auth"===j||"auth-int"===j||"MD5-sess"===a)&&(u+="nc="+g+", ",u+='cnonce="'+h+'", '),u+='response="'+r+'", ',u+='opaque="'+i+'"'},process:function(){var a,b=pm.request.headers,c="Authorization",d=findPosition(b,"key",c);$("#request-helper-digestAuth-realm").val();a=pm.helpers.digest.getHeader(),a="Digest"+a,d>=0?b[d]={key:c,name:c,value:a}:b.push({key:c,name:c,value:a}),pm.request.headers=b,$("#headers-keyvaleditor").keyvalueeditor("reset",b),pm.request.openHeaderEditor()}},oAuth1:{isAutoEnabled:!1,init:function(){$("#request-helper-oauth1-auto").click(function(){var a=$("#request-helper-oauth1-auto").attr("checked")?!0:!1;pm.helpers.oAuth1.isAutoEnabled=a,a?$("#request-helper-oAuth1 .request-helper-submit").css("display","none"):$("#request-helper-oAuth1 .request-helper-submit").css("display","inline-block")})},generateHelper:function(){$("#request-helper-oauth1-timestamp").val(OAuth.timestamp()),$("#request-helper-oauth1-nonce").val(OAuth.nonce(6))},generateSignature:function(){if(""===$("#url").val())return $("#request-helpers").css("display","block"),alert("Please enter the URL first."),null;var a,b=$("#request-helper-oauth1-realm").val();a=""===b?pm.envManager.convertString($("#url").val()).trim():pm.envManager.convertString(b),a=ensureProperUrl(a),a.indexOf("?")>0&&(a=a.split("?")[0]);var c={action:a,method:pm.request.method,parameters:[]};$("input.signatureParam").each(function(){if(""!=$(this).val()||$("#request-helper-keep-empty-parameters").attr("checked")){var a=$(this).val();a=pm.envManager.convertString(a),c.parameters.push([$(this).attr("key"),a])}});var d=$("#url-keyvaleditor").keyvalueeditor("getValues"),e=[];pm.request.isMethodWithBody(pm.request.method)&&("params"==pm.request.body.mode?e=$("#formdata-keyvaleditor").keyvalueeditor("getValues"):"urlencoded"==pm.request.body.mode&&(e=$("#urlencoded-keyvaleditor").keyvalueeditor("getValues")));for(var f=d.concat(e),g=0;g<f.length;g++){var h=f[g];h.key&&(h.value=pm.envManager.convertString(h.value),c.parameters.push([h.key,h.value]))}var i={};return""!=$('input[key="oauth_consumer_secret"]').val()&&(i.consumerSecret=$('input[key="oauth_consumer_secret"]').val(),i.consumerSecret=pm.envManager.convertString(i.consumerSecret)),""!=$('input[key="oauth_token_secret"]').val()&&(i.tokenSecret=$('input[key="oauth_token_secret"]').val(),i.tokenSecret=pm.envManager.convertString(i.tokenSecret)),OAuth.SignatureMethod.sign(c,i)},removeOAuthKeys:function(a){var b,c,d=["oauth_consumer_key","oauth_token","oauth_signature_method","oauth_timestamp","oauth_nonce","oauth_version","oauth_signature"],e=[];for(b=0,c=a.length;c>b;b++){var f=_.indexOf(d,a[b].key);0>f&&e.push(a[b])}return e},process:function(){var a,b,c=[],d=pm.request.getUrlEditorParams(),e=[];"params"===pm.request.body.mode?e=$("#formdata-keyvaleditor").keyvalueeditor("getValues"):"urlencoded"===pm.request.body.mode&&(e=$("#urlencoded-keyvaleditor").keyvalueeditor("getValues")),c=c.concat(d),c=c.concat(e),c=pm.helpers.oAuth1.removeOAuthKeys(c);var f="oauth_signature";for($("input.signatureParam").each(function(){if(""!=$(this).val()||$("#request-helper-keep-empty-parameters").attr("checked")){var a=$(this).val();c.push({key:$(this).attr("key"),value:a})}}),a=0,b=c.length;b>a;a++)c[a].value=pm.envManager.convertString(c[a].value);var g=this.generateSignature();if(null!=g){c.push({key:f,value:g});var h=$("#request-helper-oauth1-header").attr("checked")?!0:!1;if(h){var i=$("#request-helper-oauth1-realm").val();""===i&&(i=pm.envManager.convertString($("#url").val()).trim()),i.indexOf("?")>0&&(i=i.split("?")[0]);var j=pm.request.headers,k="Authorization",l=findPosition(j,"key",k),m='OAuth realm="'+i+'",',n=c.length;for(a=0;n>a;a++)m+=encodeURIComponent(c[a].key)+'="'+encodeURIComponent(c[a].value)+'",';m=m.substring(0,m.length-1),l>=0?j[l]={key:k,name:k,value:m}:j.push({key:k,name:k,value:m}),pm.request.headers=j,$("#headers-keyvaleditor").keyvalueeditor("reset",j),pm.request.openHeaderEditor()}else if("GET"===pm.request.method)$("#url-keyvaleditor").keyvalueeditor("reset",c),pm.request.setUrlParamString(c),pm.request.openUrlEditor();else{var o=pm.request.body.getDataMode();"urlencoded"===o?$("#urlencoded-keyvaleditor").keyvalueeditor("reset",c):"params"===o&&$("#formdata-keyvaleditor").keyvalueeditor("reset",c)}}}}},pm.history={requests:{},init:function(){$(".history-actions-delete").click(function(){pm.history.clear()})},showEmptyMessage:function(){$("#emptyHistoryMessage").css("display","block")},hideEmptyMessage:function(){$("#emptyHistoryMessage").css("display","none")},requestExists:function(a){var b=-1,c=a.method.toLowerCase();if(pm.request.isMethodWithBody(c))return-1;for(var d=this.requests,e=d.length,f=0;e>f;f++){var g=d[f];if(g.url.length!==a.url.length||g.headers.length!==a.headers.length||g.method!==a.method?b=-1:g.url===a.url&&g.headers===a.headers&&(b=f),b>=0)break}return b},getAllRequests:function(){pm.indexedDB.getAllRequestItems(function(a){var b=[],c=a.length;if(0===c)$("#sidebar-section-history").append(Handlebars.templates.message_no_history({}));else{for(var d=0;c>d;d++){var e=a[d];pm.urlCache.addUrl(e.url);var f=a[d].url;f.length>80&&(f=f.substring(0,80)+"..."),f=limitStringLineWidth(f,40);var g={url:f,method:a[d].method,id:a[d].id,position:"top"};b.push(g)}b.reverse(),$("#history-items").append(Handlebars.templates.history_sidebar_requests({items:b})),$("#history-items").fadeIn()}pm.history.requests=a,pm.layout.refreshScrollPanes()})},loadRequest:function(a){pm.indexedDB.getRequest(a,function(a){pm.request.isFromCollection=!1,$(".sidebar-collection-request").removeClass("sidebar-collection-request-active"),pm.request.loadRequestInEditor(a)})},addRequest:function(a,b,c,d,e){var f=guid(),g=pm.settings.get("historyCount"),h=this.requests,i=this.requests.length;if(g>0&&i>=g){var j=h[0];this.deleteRequest(j.id)}var k={id:f,url:a.toString(),method:b.toString(),headers:c.toString(),data:d,dataMode:e.toString(),timestamp:(new Date).getTime(),version:2},l=this.requestExists(k);if(l>=0){var m=h[l].id;this.deleteRequest(m)}pm.indexedDB.addRequest(k,function(a){pm.urlCache.addUrl(a.url),pm.layout.sidebar.addRequest(a.url,a.method,f,"top"),pm.history.requests.push(a)})},deleteRequest:function(a){pm.indexedDB.deleteRequest(a,function(a){for(var b=pm.history.requests,c=-1,d=b.length,e=0;d>e;e++)if(b[e].id===a){c=e;break}c>=0&&b.splice(c,1),pm.layout.sidebar.removeRequestFromHistory(a)})},clear:function(){pm.indexedDB.deleteHistory(function(){$("#history-items").html("")})}},pm.indexedDB={TABLE_HEADER_PRESETS:"header_presets",onerror:function(a,b){console.log(a)},open_v21:function(){var a=indexedDB.open("postman","POSTman request history");a.onsuccess=function(a){var b="0.6";pm.indexedDB.db=a.target.result;var c=pm.indexedDB.db;if(b!==c.version){var d=c.setVersion(b);d.onfailure=function(a){console.log(a)},d.onsuccess=function(a){if(!c.objectStoreNames.contains("requests")){var b=c.createObjectStore("requests",{keyPath:"id"});b.createIndex("timestamp","timestamp",{unique:!1})}if(!c.objectStoreNames.contains("collections")){var d=c.createObjectStore("collections",{keyPath:"id"});d.createIndex("timestamp","timestamp",{unique:!1})}if(!c.objectStoreNames.contains("collection_requests")){var e=c.createObjectStore("collection_requests",{keyPath:"id"});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("collectionId","collectionId",{unique:!1})}if(c.objectStoreNames.contains("collection_responses")&&c.deleteObjectStore("collection_responses"),!c.objectStoreNames.contains("environments")){var f=c.createObjectStore("environments",{keyPath:"id"});f.createIndex("timestamp","timestamp",{unique:!1}),f.createIndex("id","id",{unique:!1})}if(!c.objectStoreNames.contains("header_presets")){var b=c.createObjectStore("header_presets",{keyPath:"id"});b.createIndex("timestamp","timestamp",{unique:!1})}var g=a.target.result;g.oncomplete=function(){pm.history.getAllRequests(),pm.envManager.getAllEnvironments(),pm.headerPresets.init()}},d.onupgradeneeded=function(a){}}else pm.history.getAllRequests(),pm.envManager.getAllEnvironments(),pm.headerPresets.init()},a.onfailure=pm.indexedDB.onerror},open_latest:function(){var a=11,b=indexedDB.open("postman",a);b.onupgradeneeded=function(a){var b=a.target.result;if(pm.indexedDB.db=b,!b.objectStoreNames.contains("requests")){var c=b.createObjectStore("requests",{keyPath:"id"});c.createIndex("timestamp","timestamp",{unique:!1})}if(!b.objectStoreNames.contains("collections")){var d=b.createObjectStore("collections",{keyPath:"id"});d.createIndex("timestamp","timestamp",{unique:!1})}if(!b.objectStoreNames.contains("collection_requests")){var e=b.createObjectStore("collection_requests",{keyPath:"id"});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("collectionId","collectionId",{unique:!1})}if(b.objectStoreNames.contains("collection_responses")&&b.deleteObjectStore("collection_responses"),!b.objectStoreNames.contains("environments")){var f=b.createObjectStore("environments",{keyPath:"id"});f.createIndex("timestamp","timestamp",{unique:!1}),f.createIndex("id","id",{unique:!1})}if(!b.objectStoreNames.contains("header_presets")){var c=b.createObjectStore("header_presets",{keyPath:"id"});c.createIndex("timestamp","timestamp",{unique:!1})}},b.onsuccess=function(a){pm.indexedDB.db=a.target.result,pm.history.getAllRequests(),pm.envManager.getAllEnvironments(),pm.headerPresets.init()},b.onerror=pm.indexedDB.onerror},open:function(){parseInt(navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./)[2])<23?pm.indexedDB.open_v21():pm.indexedDB.open_latest()},addCollection:function(a,b){var c,d=pm.indexedDB.db,e=d.transaction(["collections"],"readwrite"),f=e.objectStore("collections");c="order"in a?f.put({id:a.id,name:a.name,order:a.order,timestamp:(new Date).getTime()}):f.put({id:a.id,name:a.name,timestamp:(new Date).getTime()}),c.onsuccess=function(){b(a)},c.onerror=function(a){console.log(a.value)}},updateCollection:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collections"],"readwrite"),e=d.objectStore("collections"),f=(IDBKeyRange.only(a.id),e.put(a));f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a.value)}},addCollectionRequest:function(a,b){var c,d=pm.indexedDB.db,e=d.transaction(["collection_requests"],"readwrite"),f=e.objectStore("collection_requests");c="version"in a?a.version:1;var g=f.put({collectionId:a.collectionId,id:a.id,name:a.name,description:a.description,url:a.url.toString(),method:a.method.toString(),headers:a.headers.toString(),data:a.data,dataMode:a.dataMode.toString(),timestamp:a.timestamp,responses:a.responses,version:a.version});g.onsuccess=function(){b(a)},g.onerror=function(a){console.log(a.value)}},updateCollectionRequest:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collection_requests"],"readwrite"),e=d.objectStore("collection_requests"),f=(IDBKeyRange.only(a.id),e.put(a));f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a.value)}},getCollection:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collections"],"readwrite"),e=d.objectStore("collections"),f=e.get(a);f.onsuccess=function(a){var c=a.target.result;b(c)},f.onerror=pm.indexedDB.onerror},getCollections:function(a){var b=pm.indexedDB.db;if(null!=b){var c=b.transaction(["collections"],"readwrite"),d=c.objectStore("collections"),e=IDBKeyRange.lowerBound(0),f=d.openCursor(e),g=0,h=[];f.onsuccess=function(b){var c=b.target.result;if(!c)return void a(h);var d=c.value;g++,h.push(d),c["continue"]()},f.onerror=function(a){console.log(a)}}},getAllRequestsInCollection:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collection_requests"],"readwrite"),e=IDBKeyRange.only(a.id),f=d.objectStore("collection_requests"),g=f.index("collectionId"),h=g.openCursor(e),i=[];h.onsuccess=function(c){var d=c.target.result;if(!d)return void b(a,i);var e=d.value;i.push(e),d["continue"]()},h.onerror=pm.indexedDB.onerror},addRequest:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["requests"],"readwrite"),e=d.objectStore("requests"),f=e.put(a);f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a.value)}},getRequest:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["requests"],"readwrite"),e=d.objectStore("requests"),f=e.get(a);f.onsuccess=function(a){var c=a.target.result;c&&b(c)},f.onerror=pm.indexedDB.onerror},getCollectionRequest:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collection_requests"],"readwrite"),e=d.objectStore("collection_requests"),f=e.get(a);f.onsuccess=function(a){var c=a.target.result;if(c)return b(c),c},f.onerror=pm.indexedDB.onerror},getAllRequestItems:function(a){var b=pm.indexedDB.db;if(null!=b){var c=b.transaction(["requests"],"readwrite"),d=c.objectStore("requests"),e=IDBKeyRange.lowerBound(0),f=d.index("timestamp"),g=f.openCursor(e),h=[];g.onsuccess=function(b){var c=b.target.result;if(!c)return void a(h);var d=c.value;h.push(d),c["continue"]()},g.onerror=pm.indexedDB.onerror}},deleteRequest:function(a,b){try{var c=pm.indexedDB.db,d=c.transaction(["requests"],"readwrite"),e=d.objectStore(["requests"]),f=e["delete"](a);f.onsuccess=function(){b(a)},f.onerror=function(a){console.log(a)}}catch(g){console.log(g)}},deleteHistory:function(a){var b=pm.indexedDB.db,c=b.transaction(["requests"],"readwrite"),d=c.objectStore(["requests"]).clear();d.onsuccess=function(b){a()}},deleteCollectionRequest:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collection_requests"],"readwrite"),e=d.objectStore(["collection_requests"]),f=e["delete"](a);f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a)}},deleteAllCollectionRequests:function(a){var b=pm.indexedDB.db,c=b.transaction(["collection_requests"],"readwrite"),d=IDBKeyRange.only(a),e=c.objectStore("collection_requests"),f=e.index("collectionId"),g=f.openCursor(d);g.onsuccess=function(a){var b=a.target.result;if(b){var c=b.value;pm.collections.deleteCollectionRequest(c.id),b["continue"]()}},g.onerror=pm.indexedDB.onerror},deleteCollection:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["collections"],"readwrite"),e=d.objectStore(["collections"]),f=e["delete"](a);f.onsuccess=function(){pm.indexedDB.deleteAllCollectionRequests(a),b(a)},f.onerror=function(a){console.log(a)}},environments:{addEnvironment:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["environments"],"readwrite"),e=d.objectStore("environments"),f=e.put(a);f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a)}},getEnvironment:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["environments"],"readwrite"),e=d.objectStore("environments"),f=e.get(a);f.onsuccess=function(a){var c=a.target.result;b(c)},f.onerror=pm.indexedDB.onerror},deleteEnvironment:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["environments"],"readwrite"),e=d.objectStore(["environments"]),f=e["delete"](a);f.onsuccess=function(){b(a)},f.onerror=function(a){console.log(a)}},getAllEnvironments:function(a){var b=pm.indexedDB.db;if(null!=b){var c=b.transaction(["environments"],"readwrite"),d=c.objectStore("environments"),e=IDBKeyRange.lowerBound(0),f=d.index("timestamp"),g=f.openCursor(e),h=[];g.onsuccess=function(b){var c=b.target.result;if(!c)return void a(h);var d=c.value;h.push(d),c["continue"]()},g.onerror=pm.indexedDB.onerror}},updateEnvironment:function(a,b){var c=pm.indexedDB.db,d=c.transaction(["environments"],"readwrite"),e=d.objectStore("environments"),f=(IDBKeyRange.only(a.id),e.put(a));f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a.value)}}},headerPresets:{addHeaderPreset:function(a,b){var c=pm.indexedDB.db,d=c.transaction([pm.indexedDB.TABLE_HEADER_PRESETS],"readwrite"),e=d.objectStore(pm.indexedDB.TABLE_HEADER_PRESETS),f=e.put(a);f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a)}},getHeaderPreset:function(a,b){var c=pm.indexedDB.db,d=c.transaction([pm.indexedDB.TABLE_HEADER_PRESETS],"readwrite"),e=d.objectStore(pm.indexedDB.TABLE_HEADER_PRESETS),f=e.get(a);f.onsuccess=function(a){var c=a.target.result;b(c)},f.onerror=pm.indexedDB.onerror},deleteHeaderPreset:function(a,b){var c=pm.indexedDB.db,d=c.transaction([pm.indexedDB.TABLE_HEADER_PRESETS],"readwrite"),e=d.objectStore([pm.indexedDB.TABLE_HEADER_PRESETS]),f=e["delete"](a);f.onsuccess=function(){b(a)},f.onerror=function(a){console.log(a)}},getAllHeaderPresets:function(a){var b=pm.indexedDB.db;if(null==b)return void console.log("Db is null");var c=b.transaction([pm.indexedDB.TABLE_HEADER_PRESETS],"readwrite"),d=c.objectStore(pm.indexedDB.TABLE_HEADER_PRESETS),e=IDBKeyRange.lowerBound(0),f=d.index("timestamp"),g=f.openCursor(e),h=[];g.onsuccess=function(b){var c=b.target.result;if(!c)return void a(h);var d=c.value;h.push(d),c["continue"]()},g.onerror=pm.indexedDB.onerror},updateHeaderPreset:function(a,b){var c=pm.indexedDB.db,d=c.transaction([pm.indexedDB.TABLE_HEADER_PRESETS],"readwrite"),e=d.objectStore(pm.indexedDB.TABLE_HEADER_PRESETS),f=(IDBKeyRange.only(a.id),e.put(a));f.onsuccess=function(c){b(a)},f.onerror=function(a){console.log(a.value)}}},downloadAllData:function(a){console.log("Starting to download all data");var b=0,c=0,d=[],e=[],f=[],g=[],h=function(a){var e=a.requests;console.log("Found collection",a);for(var f=0;f<e.length;f++)console.log(e[f].name),e[f].hasOwnProperty("name")?"undefined"==typeof e[f].name&&(console.log("No name found"),e[f].name=e[f].url):(console.log("No name found"),e[f].name=e[f].url);d.push(a),c++,c===b&&i(d)},i=function(b){console.log(pm.envManager),e=pm.envManager.globals,pm.indexedDB.environments.getAllEnvironments(function(b){f=b,pm.indexedDB.headerPresets.getAllHeaderPresets(function(b){g=b,j(a)})})},j=function(){console.log("collections",d),console.log("environments",f),console.log("headerPresets",g),console.log("globals",e);var b={version:1,collections:d,environments:f,headerPresets:g,globals:e},c="Backup.postman_dump",h=JSON.stringify(b),i="application/json";console.log("File data is ",h),pm.filesystem.saveAndOpenFile(c,h,i,function(){a&&a()})};pm.indexedDB.getCollections(function(c){function d(a,b){a.requests=b,h(a)}b=c.length,pm.collections.items=c;var i=c.length;if(0!==i)for(var k=0;i>k;k++){var l=c[k];pm.indexedDB.getAllRequestsInCollection(l,d)}else e=pm.envManager.globals,pm.indexedDB.environments.getAllEnvironments(function(b){f=b,pm.indexedDB.headerPresets.getAllHeaderPresets(function(b){g=b,j(a)})})})}},pm.jsonlint={instance:null,init:function(){pm.jsonlint.instance=jsonlint_postman,jsonlint_postman=null}},pm.keymap={init:function(){var a=function(){return pm.layout.isModalOpen?void 0:(pm.history.clear(),!1)},b=function(){return pm.layout.isModalOpen?void 0:($("#url").focus(),!1)},c=function(){pm.layout.isModalOpen||pm.request.startNew()};$("body").on("keydown","input",function(a){return pm.layout.isModalOpen?void 0:(27===a.keyCode?$(a.target).blur():13==a.keyCode&&pm.request.send("text"),!0)}),$("body").on("keydown","textarea",function(a){pm.layout.isModalOpen||27===a.keyCode&&$(a.target).blur()}),$("body").on("keydown","select",function(a){27===a.keyCode&&$(a.target).blur()}),$(document).bind("keydown","alt+c",a),$(document).bind("keydown","backspace",b),$(document).bind("keydown","alt+n",c),$(document).bind("keydown","alt+p",function(){pm.request.handlePreviewClick()}),$(document).bind("keydown","q",function(){return pm.envManager.quicklook.toggleDisplay(),!1}),$(document).bind("keydown","e",function(){pm.layout.isModalOpen||$("#modal-environments").modal({keyboard:!0,backdrop:"static"})}),$(document).bind("keydown","h",function(){return pm.layout.isModalOpen?void 0:(pm.request.openHeaderEditor(),$("#headers-keyvaleditor div:first-child input:first-child").focus(),!1)}),$(document).bind("keydown","return",function(){return pm.layout.isModalOpen?void 0:(pm.request.send("text"),!1)}),$(document).bind("keydown","p",function(){return pm.layout.isModalOpen?void 0:pm.request.isMethodWithBody(pm.request.method)?($("#formdata-keyvaleditor div:first-child input:first-child").focus(),!1):void 0}),$(document).bind("keydown","f",function(){pm.layout.isModalOpen||pm.request.response.toggleBodySize()}),$(document).bind("keydown","esc",function(){if(pm.layout.isModalOpen){var a=pm.layout.activeModal;""!==a&&$(a).modal("hide")}}),$(document).bind("keydown","shift+/",function(){pm.layout.isModalOpen||($("#modal-shortcuts").modal({keyboard:!0}),$("#modal-shortcuts").modal("show"))}),$(document).bind("keydown","a",function(){return pm.layout.isModalOpen?void 0:(pm.collections.areLoaded===!1&&pm.collections.getAllCollections(),$("#modal-add-to-collection").modal({keyboard:!0,backdrop:"static"}),$("#modal-add-to-collection").modal("show"),$("#new-request-name").val(""),$("#new-request-description").val(""),!1)})}},pm.layout={isModalOpen:!1,activeModal:"",socialButtons:{facebook:'<iframe src="http://www.facebook.com/plugins/like.php?href=https%3A%2F%2Fchrome.google.com%2Fwebstore%2Fdetail%2Ffdmmgilgnpjigdojojpjoooidkmcomcm&amp;send=false&amp;layout=button_count&amp;width=250&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=26438002524" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:250px; height:21px;" allowTransparency="true"></iframe>',twitter:'<a href="https://twitter.com/share" class="twitter-share-button" data-url="https://chrome.google.com/webstore/detail/fdmmgilgnpjigdojojpjoooidkmcomcm" data-text="I am using Postman to super-charge REST API testing and development!" data-count="horizontal" data-via="postmanclient">Tweet</a><script type="text/javascript" src="https://platform.twitter.com/widgets.js"></script>',plusOne:'<script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script><g:plusone size="medium" href="https://chrome.google.com/webstore/detail/fdmmgilgnpjigdojojpjoooidkmcomcm"></g:plusone>'},detectLauncher:function(){if(!pm.debug){var a=pm.settings.get("launcherNotificationCount");if(a>=1)return!0;noty({type:"information",text:"Click here to get the Postman Launcher for quick access to Postman from the Chrome toolbar",layout:"topRight",callback:{onClose:function(){var a="https://chrome.google.com/webstore/detail/postman-launcher/igofndmniooofoabmmpfonmdnhgchoka";window.open(a,"_blank"),window.focus()}}});var a=parseInt(pm.settings.get("launcherNotificationCount"))+1;pm.settings.set("launcherNotificationCount",a)}},init:function(){pm.layout.detectLauncher(),1==pm.settings.get("haveDonated")&&(console.log("Donated"),pm.layout.hideDonationBar()),$("#make-postman-better").on("click",function(){$("#modal-spread-the-word").modal("show"),pm.layout.attachSocialButtons()}),$("#donate").on("click",function(){$("#donate-form form").submit()}),$("#download-all-data").on("click",function(){pm.indexedDB.downloadAllData(function(){tracker.sendEvent("data","download"),console.log("Downloaded all data")})}),$("#postman-wiki").on("click",function(){tracker.sendEvent("wiki","click")}),$("#upgrade").on("click",function(){tracker.sendEvent("upgrade","click")});var a="<div class='supporters'><div class='supporter clearfix'>";a+="<div class='supporter-image supporter-image-mashape'>",a+="<a href='http://www.getpostman.com/r?url=https://www.mashape.com/?utm_source=chrome%26utm_medium=app%26utm_campaign=postman' target='_blank'>",a+="<img src='img/supporters/mashape.png'/></a></div>",a+="<div class='supporter-tag'>Consume or provide cloud services with the Mashape API Platform.</div></div>",a+="<div class='supporter clearfix'>",a+="<div class='supporter-image supporter-image-mashape'>",a+="<a href='http://www.getpostman.com/r?url=http://restlet.com/?utm_source=POSTMAN' target='_blank'>",a+="<img src='img/supporters/restlet.png'/></a></div>",a+="<div class='supporter-tag'>The all-in-one platform for web APIs.</div></div>",a+="<div class='supporter clearfix'>",a+="<div class='supporter-image supporter-image-mashape'>",a+="<a href='http://www.getpostman.com/r?url=http://www.nextbigwhat.com/bighackathon-details-297/' target='_blank'>",a+="<img src='img/supporters/nextbigwhat.png'/></a></div>",a+="<div class='supporter-tag'>Use the code <strong>nextbigwhat</strong> to participate in the NBW hackathon on November 15 for free! ",a+="<a href='http://www.getpostman.com/r?url=http://www.nextbigwhat.com/bighackathon-details-297/'>See details</a></div></div>";var b;$("#upgrade").popover(),$("#donate").popover({animation:!1,content:a,placement:"top",trigger:"manual",html:!0,title:"Postman is supported by some amazing companies"}).on("mouseenter",function(){var a=this;$(this).popover("show"),$(this).siblings(".popover").on("mouseleave",function(){$(a).popover("hide")}),b=setTimeout(function(){tracker.sendEvent("sponsors","view")},1e3)}).on("mouseleave",function(){var a=this;clearTimeout(b),setTimeout(function(){$(".popover:hover").length||$(a).popover("hide")},100)}),$("#response-body-toggle").on("click",function(){pm.request.response.toggleBodySize()}),$("#response-body-line-wrapping").on("click",function(){return pm.editor.toggleLineWrapping(),!0}),$("#response-open-in-new-window").on("click",function(){var a=pm.request.response.text;pm.request.response.openInNewWindow(a)}),$("#response-formatting").on("click","a",function(){var a=$(this).attr("data-type");pm.request.response.changePreviewType(a)}),$("#response-language").on("click","a",function(){var a=$(this).attr("data-mode");pm.request.response.setMode(a)}),$("#response-sample-save-start").on("click",function(){$("#response-sample-save-start-container").css("display","none"),$("#response-sample-save-form").css("display","inline-block")}),$("#response-sample-cancel").on("click",function(){$("#response-sample-save-start-container").css("display","inline-block"),$("#response-sample-save-form").css("display","none")}),$("#response-sample-save").on("click",function(){var a=$("#url").val(),b=pm.request.response,c=new CollectionRequest;c.id=guid(),c.headers=pm.request.getPackedHeaders(),c.url=a,c.method=pm.request.method,c.data=pm.request.body.getData(),c.dataMode=pm.request.dataMode,c.time=(new Date).getTime();var d=$("#response-sample-name").val(),e={
id:guid(),name:d,collectionRequestId:pm.request.collectionRequestId,request:c,responseCode:b.responseCode,time:b.time,headers:b.headers,cookies:b.cookies,text:b.text};pm.collections.saveResponseAsSample(e),$("#response-sample-save-start-container").css("display","inline-block"),$("#response-sample-save-form").css("display","none")}),this.sidebar.init(),pm.request.response.clear(),$("#sidebar-selectors li a").click(function(){var a=$(this).attr("data-id");pm.layout.sidebar.select(a)}),$('a[rel="tooltip"]').tooltip(),$('input[rel="popover"]').popover(),$("#form-add-to-collection").submit(function(){return pm.collections.addRequestToCollection(),$("#modal-add-to-collection").modal("hide"),!1}),$("#modal-add-to-collection .btn-primary").click(function(){pm.collections.addRequestToCollection(),$("#modal-add-to-collection").modal("hide")}),$("#form-new-collection").submit(function(){return pm.collections.addCollection(),!1}),$("#form-edit-collection").submit(function(){var a=$("#form-edit-collection .collection-id").val(),b=$("#form-edit-collection .collection-name").val();return pm.collections.updateCollection(a,b),$("#modal-edit-collection").modal("hide"),!1}),$("#form-edit-collection-request").submit(function(){var a=$("#form-edit-collection-request .collection-request-id").val(),b=$("#form-edit-collection-request .collection-request-name").val(),c=$("#form-edit-collection-request .collection-request-description").val();return pm.collections.updateCollectionRequestMeta(a,b,c),!1}),$("#modal-new-collection .btn-primary").click(function(){return pm.collections.addCollection(),!1}),$("#modal-edit-collection .btn-primary").click(function(){var a=$("#form-edit-collection .collection-id").val(),b=$("#form-edit-collection .collection-name").val();pm.collections.updateCollectionMeta(a,b),$("#modal-edit-collection").modal("hide")}),$("#modal-edit-collection-request .btn-primary").click(function(){var a=$("#form-edit-collection-request .collection-request-id").val(),b=$("#form-edit-collection-request .collection-request-name").val(),c=$("#form-edit-collection-request .collection-request-description").val();pm.collections.updateCollectionRequestMeta(a,b,c)}),$(window).resize(function(){pm.layout.setLayout()}),$("#response-data").on("mousedown",".cm-link",function(){var a=$(this).html(),b=$("#headers-keyvaleditor").keyvalueeditor("getValues");pm.request.loadRequestFromLink(a,b)}),$(".response-tabs").on("click","li",function(){var a=$(this).attr("data-section");"body"===a?pm.request.response.showBody():"headers"===a?pm.request.response.showHeaders():"cookies"===a&&pm.request.response.showCookies()}),$("#request-meta").on("mouseenter",function(){$(".request-meta-actions").css("display","block")}),$("#request-meta").on("mouseleave",function(){$(".request-meta-actions").css("display","none")}),this.attachModalHandlers(),this.setLayout()},onModalOpen:function(a){pm.layout.activeModal=a,pm.layout.isModalOpen=!0},onModalClose:function(){pm.layout.activeModal="",pm.layout.isModalOpen=!1},attachModalHandlers:function(){$("#modal-new-collection").on("shown",function(){$("#new-collection-blank").focus(),pm.layout.onModalOpen("#modal-new-collection")}),$("#modal-new-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-edit-collection").on("shown",function(){$("#modal-edit-collection .collection-name").focus(),pm.layout.onModalOpen("#modal-edit-collection")}),$("#modal-edit-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-edit-collection-request").on("shown",function(){$("#modal-edit-collection-request .collection-request-name").focus(),pm.layout.onModalOpen("#modal-edit-collection-request")}),$("#modal-edit-collection-request").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-add-to-collection").on("shown",function(){$("#select-collection").focus(),pm.layout.onModalOpen("#modal-add-to-collection")}),$("#modal-add-to-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-share-collection").on("shown",function(){pm.layout.onModalOpen("#modal-share-collection")}),$("#modal-share-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-import-collection").on("shown",function(){pm.layout.onModalOpen("#modal-import-collection")}),$("#modal-import-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-delete-collection").on("shown",function(){pm.layout.onModalOpen("#modal-delete-collection")}),$("#modal-delete-collection").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-environments").on("shown",function(){$(".environments-actions-add").focus(),pm.layout.onModalOpen("#modal-environments")}),$("#modal-environments").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-header-presets").on("shown",function(){$(".header-presets-actions-add").focus(),pm.layout.onModalOpen("#modal-header-presets")}),$("#modal-header-presets").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-settings").on("shown",function(){$("#history-count").focus(),pm.layout.onModalOpen("#modal-settings")}),$("#modal-settings").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-spread-the-word").on("shown",function(){pm.layout.onModalOpen("#modal-spread-the-word")}),$("#modal-spread-the-word").on("hidden",function(){pm.layout.onModalClose()}),$("#modal-shortcuts").on("shown",function(){pm.layout.onModalOpen("#modal-shortcuts")}),$("#modal-shortcuts").on("hidden",function(){pm.layout.onModalClose()})},attachSocialButtons:function(){var a=$("#about-postman-twitter-button").html();""!==a&&a||$("#about-postman-twitter-button").html(this.socialButtons.twitter),a=$("#about-postman-plus-one-button").html(),""!==a&&a||$("#about-postman-plus-one-button").html(this.socialButtons.plusOne),a=$("#about-postman-facebook-button").html(),""!==a&&a||$("#about-postman-facebook-button").html(this.socialButtons.facebook)},setLayout:function(){this.refreshScrollPanes()},refreshScrollPanes:function(){var a=$("#container").width()-$("#sidebar").width();$("#main").width(a+"px"),$("#sidebar").width()>100&&$("#sidebar").jScrollPane({mouseWheelSpeed:24})},hideDonationBar:function(){$("#sidebar-footer").css("display","none")},sidebar:{currentSection:"history",isSidebarMaximized:!0,sections:["history","collections"],width:0,animationDuration:250,minimizeSidebar:function(){var a=pm.layout.sidebar.animationDuration;$("#sidebar-toggle").animate({left:"0"},a),$("#sidebar").animate({width:"5px"},a),$("#sidebar-footer").css("display","none"),$("#sidebar div").animate({opacity:0},a);var b=$(document).width()-5;$("#main").animate({width:b+"px","margin-left":"5px"},a),$("#sidebar-toggle img").attr("src","img/tri_arrow_right.png")},maximizeSidebar:function(){var a=pm.layout.sidebar.animationDuration;$("#sidebar-toggle").animate({left:"350px"},a,function(){$("#sidebar-footer").fadeIn()}),$("#sidebar").animate({width:pm.layout.sidebar.width+"px"},a),$("#sidebar div").animate({opacity:1},a),$("#sidebar-toggle img").attr("src","img/tri_arrow_left.png");var b=$(document).width()-pm.layout.sidebar.width;$("#main").animate({width:b+"px","margin-left":pm.layout.sidebar.width+"px"},a),pm.layout.refreshScrollPanes()},toggleSidebar:function(){var a=pm.layout.sidebar.isSidebarMaximized;a?pm.layout.sidebar.minimizeSidebar():pm.layout.sidebar.maximizeSidebar(),pm.layout.sidebar.isSidebarMaximized=!a},init:function(){$("#history-items").on("click",".request-actions-delete",function(){var a=$(this).attr("data-request-id");pm.history.deleteRequest(a)}),$("#history-items").on("click",".request",function(){var a=$(this).attr("data-request-id");pm.history.loadRequest(a)}),$("#sidebar-toggle").on("click",function(){pm.layout.sidebar.toggleSidebar()}),pm.layout.sidebar.width=$("#sidebar").width()+10,this.addRequestListeners()},select:function(a){return pm.collections.areLoaded===!1&&pm.collections.getAllCollections(),$("#sidebar-section-"+this.currentSection).css("display","none"),$("#"+this.currentSection+"-options").css("display","none"),this.currentSection=a,$("#sidebar-section-"+a).fadeIn(),$("#"+a+"-options").css("display","block"),pm.layout.refreshScrollPanes(),!0},addRequest:function(a,b,c,d){a.length>80&&(a=a.substring(0,80)+"..."),a=limitStringLineWidth(a,40);var e={url:a,method:b,id:c,position:d};"top"===d?$("#history-items").prepend(Handlebars.templates.item_history_sidebar_request(e)):$("#history-items").append(Handlebars.templates.item_history_sidebar_request(e)),$("#sidebar-section-history .empty-message").css("display","none"),pm.layout.refreshScrollPanes()},addRequestListeners:function(){$("#sidebar-sections").on("mouseenter",".sidebar-request",function(){var a=jQuery(".request-actions",this);a.css("display","block")}),$("#sidebar-sections").on("mouseleave",".sidebar-request",function(){var a=jQuery(".request-actions",this);a.css("display","none")})},emptyCollectionInSidebar:function(a){$("#collection-requests-"+a).html("")},removeRequestFromHistory:function(a,b){b?$("#sidebar-request-"+a).slideUp(100):$("#sidebar-request-"+a).remove(),0===pm.history.requests.length?pm.history.showEmptyMessage():pm.history.hideEmptyMessage(),pm.layout.refreshScrollPanes()},removeCollection:function(a){$("#collection-"+a).remove(),pm.layout.refreshScrollPanes()}}},pm.request={url:"",urlParams:{},name:"",description:"",bodyParams:{},headers:[],method:"GET",dataMode:"params",isFromCollection:!1,collectionRequestId:"",methodsWithBody:["POST","PUT","PATCH","DELETE","LINK","UNLINK"],areListenersAdded:!1,startTime:0,endTime:0,xhr:null,editorMode:0,responses:[],body:{mode:"params",data:"",isEditorInitialized:!1,codeMirror:!1,init:function(){this.initPreview(),this.initFormDataEditor(),this.initUrlEncodedEditor(),this.initEditorListeners()},initPreview:function(){$(".request-preview-header-limitations").dropdown()},hide:function(){pm.request.body.closeFormDataEditor(),pm.request.body.closeUrlEncodedEditor(),$("#data").css("display","none")},getRawData:function(){return pm.request.body.isEditorInitialized?pm.request.body.codeMirror.getValue():""},loadRawData:function(a){var b=pm.request.body;b.isEditorInitialized===!0&&(b.codeMirror.setValue(a),b.codeMirror.refresh())},initCodeMirrorEditor:function(){pm.request.body.isEditorInitialized=!0;var a=document.getElementById("body");pm.request.body.codeMirror=CodeMirror.fromTextArea(a,{mode:"htmlmixed",lineNumbers:!0,theme:"eclipse"}),$("#request .CodeMirror").resizable({stop:function(){pm.request.body.codeMirror.refresh()},resize:function(a,b){b.size.width=b.originalSize.width,$(".CodeMirror-scroll").height($(this).height()),pm.request.body.codeMirror.refresh()}}),$("#request .CodeMirror-scroll").css("height","200px"),pm.request.body.codeMirror.refresh()},setEditorMode:function(a,b){var c=$("#body-editor-mode-selector a[data-language='"+b+"']").html();$("#body-editor-mode-item-selected").html(c),pm.request.body.isEditorInitialized&&("javascript"===a?pm.request.body.codeMirror.setOption("mode",{name:"javascript",json:!0}):pm.request.body.codeMirror.setOption("mode",a),"text"===a?$("#body-editor-mode-selector-format").addClass("disabled"):$("#body-editor-mode-selector-format").removeClass("disabled"),pm.request.body.codeMirror.refresh())},autoFormatEditor:function(a){var b=pm.request.body.codeMirror.getValue(),c=null,d=null;if($("#body-editor-mode-selector-format-result").empty().hide(),pm.request.body.isEditorInitialized)if("javascript"===a)try{c=pm.jsonlint.instance.parse(b),c&&(b=JSON.parse(pm.request.body.codeMirror.getValue()),pm.request.body.codeMirror.setValue(JSON.stringify(b,null,4)))}catch(e){d=e.message,$("#body-editor-mode-selector-format-result").html(d).show()}else{var f=pm.request.body.codeMirror.lineCount();pm.request.body.codeMirror.getValue().length;pm.request.body.codeMirror.autoFormatRange({line:0,ch:0},{line:f-1,ch:pm.request.body.codeMirror.getLine(f-1).length})}},initFormDataEditor:function(){var a="#formdata-keyvaleditor",b={placeHolderKey:"Key",placeHolderValue:"Value",valueTypes:["text","file"],deleteButton:'<img class="deleteButton" src="img/delete.png">',onDeleteRow:function(){},onBlurElement:function(){}};$(a).keyvalueeditor("init",b)},initUrlEncodedEditor:function(){var a="#urlencoded-keyvaleditor",b={placeHolderKey:"Key",placeHolderValue:"Value",valueTypes:["text"],deleteButton:'<img class="deleteButton" src="img/delete.png">',onDeleteRow:function(){},onBlurElement:function(){}};$(a).keyvalueeditor("init",b)},initEditorListeners:function(){$("#body-editor-mode-selector .dropdown-menu").on("click","a",function(a){var b=$(a.target).attr("data-editor-mode"),c=$(a.target).attr("data-language");pm.request.body.setEditorMode(b,c)}),$("#body-editor-mode-selector-format").on("click.postman",function(a){$(event.target).attr("data-editor-mode");$(a.currentTarget).hasClass("disabled")})},openFormDataEditor:function(){var a="#formdata-keyvaleditor-container";$(a).css("display","block");for(var b="#formdata-keyvaleditor",c=$(b).keyvalueeditor("getValues"),d=[],e=0;e<c.length;e++){var f={key:c[e].key,value:c[e].value};d.push(f)}},closeFormDataEditor:function(){var a="#formdata-keyvaleditor-container";$(a).css("display","none")},openUrlEncodedEditor:function(){var a="#urlencoded-keyvaleditor-container";$(a).css("display","block");for(var b="#urlencoded-keyvaleditor",c=$(b).keyvalueeditor("getValues"),d=[],e=0;e<c.length;e++){var f={key:c[e].key,value:c[e].value};d.push(f)}},closeUrlEncodedEditor:function(){var a="#urlencoded-keyvaleditor-container";$(a).css("display","none")},setDataMode:function(a){pm.request.dataMode=a,pm.request.body.mode=a,$("#data-mode-selector a").removeClass("active"),$('#data-mode-selector a[data-mode="'+a+'"]').addClass("active"),$("#body-editor-mode-selector").css("display","none"),"params"===a?(pm.request.body.openFormDataEditor(),pm.request.body.closeUrlEncodedEditor(),$("#body-data-container").css("display","none")):"raw"===a?(pm.request.body.closeUrlEncodedEditor(),pm.request.body.closeFormDataEditor(),$("#body-data-container").css("display","block"),pm.request.body.isEditorInitialized===!1?pm.request.body.initCodeMirrorEditor():pm.request.body.codeMirror.refresh(),$("#body-editor-mode-selector").css("display","block")):"urlencoded"===a&&(pm.request.body.closeFormDataEditor(),pm.request.body.openUrlEncodedEditor(),$("#body-data-container").css("display","none"))},getDataMode:function(){return pm.request.body.mode},getData:function(a){var b,c,d,e,f,g=pm.request.body.mode;if("params"===g){for(c=$("#formdata-keyvaleditor").keyvalueeditor("getValues"),d=[],f=0;f<c.length;f++)e={key:c[f].key,value:c[f].value,type:c[f].type},d.push(e);if(a===!0)return d;b=pm.request.getBodyParamString(d)}else if("raw"===g)b=pm.request.body.getRawData();else if("urlencoded"===g){for(c=$("#urlencoded-keyvaleditor").keyvalueeditor("getValues"),d=[],f=0;f<c.length;f++)e={key:c[f].key,value:c[f].value,type:c[f].type},d.push(e);if(a===!0)return d;b=pm.request.getBodyParamString(d)}return b},loadData:function(a,b,c){var d=pm.request.body;d.setDataMode(a),d.data=b;var e;"params"===a?c===!0?$("#formdata-keyvaleditor").keyvalueeditor("reset",b):(e=getBodyVars(b,!1),$("#formdata-keyvaleditor").keyvalueeditor("reset",e)):"raw"===a?d.loadRawData(b):"urlencoded"===a&&(c===!0?$("#urlencoded-keyvaleditor").keyvalueeditor("reset",b):(e=getBodyVars(b,!1),$("#urlencoded-keyvaleditor").keyvalueeditor("reset",e)))}},init:function(){this.url="",this.urlParams={},this.body.data="",this.bodyParams={},this.headers=[],this.method="GET",this.dataMode="params",this.areListenersAdded||(this.areListenersAdded=!0,this.initializeHeaderEditor(),this.initializeUrlEditor(),this.body.init(),this.addListeners());var a=pm.settings.get("lastRequest");if(""!==a){var b=JSON.parse(a);pm.request.isFromCollection=!1,pm.request.loadRequestInEditor(b)}},setHeaderValue:function(a,b){var c=pm.request.headers,d=a;a=a.toLowerCase();for(var e=!1,f=0,g=c.length;g>f;f++){var h=c[f].key.toLowerCase();h===a&&"text"!==b&&(c[f].value=b,e=!0)}var i="#headers-keyvaleditor";if(!e&&"text"!==b){var j={key:d,value:b};c.push(j)}$(i).keyvalueeditor("reset",c)},getHeaderValue:function(a){var b=pm.request.headers;a=a.toLowerCase();for(var c=0,d=b.length;d>c;c++){var e=b[c].key.toLowerCase();if(e===a)return b[c].value}return!1},getHeaderEditorParams:function(){for(var a=$("#headers-keyvaleditor").keyvalueeditor("getValues"),b=[],c=0;c<a.length;c++){var d={key:a[c].key,value:a[c].value,name:a[c].key};b.push(d)}return b},onHeaderAutoCompleteItemSelect:function(a){if("preset"==a.type){var b=pm.headerPresets.getHeaderPreset(a.id);if("headers"in b){for(var c=$("#headers-keyvaleditor").keyvalueeditor("getValues"),d=-1,e=0;e<c.length;e++)if(c[e].key===a.label){d=e;break}d>=0&&c.splice(d,1);var f=_.union(c,b.headers);$("#headers-keyvaleditor").keyvalueeditor("reset",f);var g=$("#headers-keyvaleditor .keyvalueeditor-last input:first-child")[0];$("#headers-keyvaleditor .keyvalueeditor-last input:first-child")[0].focus(),setTimeout(function(){g.focus()},10)}}},initializeHeaderEditor:function(){var a={placeHolderKey:"Header",placeHolderValue:"Value",deleteButton:'<img class="deleteButton" src="img/delete.png">',onInit:function(){},onAddedParam:function(){$("#headers-keyvaleditor .keyvalueeditor-key").catcomplete({source:pm.headerPresets.presetsForAutoComplete,delay:50,select:function(a,b){pm.request.onHeaderAutoCompleteItemSelect(b.item)}})},onDeleteRow:function(){pm.request.headers=pm.request.getHeaderEditorParams(),$("#headers-keyvaleditor-actions-open .headers-count").html(pm.request.headers.length)},onFocusElement:function(){$("#headers-keyvaleditor .keyvalueeditor-key").catcomplete({source:pm.headerPresets.presetsForAutoComplete,delay:50,select:function(a,b){pm.request.onHeaderAutoCompleteItemSelect(b.item)}})},onBlurElement:function(){$("#headers-keyvaleditor .keyvalueeditor-key").catcomplete({source:pm.headerPresets.presetsForAutoComplete,delay:50,select:function(a,b){pm.request.onHeaderAutoCompleteItemSelect(b.item)}}),pm.request.headers=pm.request.getHeaderEditorParams(),$("#headers-keyvaleditor-actions-open .headers-count").html(pm.request.headers.length)},onReset:function(){var a=$("#headers-keyvaleditor").keyvalueeditor("getValues");$("#headers-keyvaleditor-actions-open .headers-count").html(a.length)}};$("#headers-keyvaleditor").keyvalueeditor("init",a),$("#headers-keyvaleditor-actions-close").on("click",function(){$("#headers-keyvaleditor-actions-open").removeClass("active"),pm.request.closeHeaderEditor()}),$("#headers-keyvaleditor-actions-open").on("click",function(){var a="block"===$("#headers-keyvaleditor-container").css("display");a?pm.request.closeHeaderEditor():pm.request.openHeaderEditor()})},getAsJson:function(){var a={url:$("#url").val(),data:pm.request.body.getData(!0),headers:pm.request.getPackedHeaders(),dataMode:pm.request.dataMode,method:pm.request.method,version:2};return JSON.stringify(a)},saveCurrentRequestToLocalStorage:function(){pm.settings.set("lastRequest",pm.request.getAsJson())},openHeaderEditor:function(){$("#headers-keyvaleditor-actions-open").addClass("active");var a="#headers-keyvaleditor-container";$(a).css("display","block")},closeHeaderEditor:function(){$("#headers-keyvaleditor-actions-open").removeClass("active");var a="#headers-keyvaleditor-container";$(a).css("display","none")},getUrlEditorParams:function(){for(var a="#url-keyvaleditor",b=$(a).keyvalueeditor("getValues"),c=[],d=0;d<b.length;d++){var e={key:b[d].key,value:b[d].value};c.push(e)}return c},initializeUrlEditor:function(){var a;a="#url-keyvaleditor";var b={placeHolderKey:"URL Parameter Key",placeHolderValue:"Value",deleteButton:'<img class="deleteButton" src="img/delete.png">',onDeleteRow:function(){pm.request.setUrlParamString(pm.request.getUrlEditorParams())},onBlurElement:function(){pm.request.setUrlParamString(pm.request.getUrlEditorParams())}};$(a).keyvalueeditor("init",b),$("#url-keyvaleditor-actions-close").on("click",function(){pm.request.closeUrlEditor()}),$("#url-keyvaleditor-actions-open").on("click",function(){var b="block"===$("#url-keyvaleditor-container").css("display");if(b)pm.request.closeUrlEditor();else{var c=getUrlVars($("#url").val(),!1);$(a).keyvalueeditor("reset",c),pm.request.openUrlEditor()}})},openUrlEditor:function(){$("#url-keyvaleditor-actions-open").addClass("active");var a="#url-keyvaleditor-container";$(a).css("display","block")},closeUrlEditor:function(){$("#url-keyvaleditor-actions-open").removeClass("active");var a="#url-keyvaleditor-container";$(a).css("display","none")},addListeners:function(){$("#data-mode-selector").on("click","a",function(){var a=$(this).attr("data-mode");pm.request.body.setDataMode(a)}),$(".request-meta-actions-togglesize").on("click",function(){var a=$(this).attr("data-action");"minimize"===a?($(this).attr("data-action","maximize"),$(".request-meta-actions-togglesize img").attr("src","img/circle_plus.png"),$("#request-description-container").slideUp(100)):($(".request-meta-actions-togglesize img").attr("src","img/circle_minus.png"),$(this).attr("data-action","minimize"),$("#request-description-container").slideDown(100))}),$("#url").keyup(function(){var a=getUrlVars($("#url").val(),!1);$("#url-keyvaleditor").keyvalueeditor("reset",a)}),$("#add-to-collection").on("click",function(){pm.collections.areLoaded===!1&&pm.collections.getAllCollections()}),$("#submit-request").on("click",function(){pm.request.send("text")}),$("#preview-request").on("click",function(){pm.request.handlePreviewClick()}),$("#update-request-in-collection").on("click",function(){pm.collections.updateCollectionFromCurrentRequest()}),$("#cancel-request").on("click",function(){pm.request.cancel()}),$("#request-actions-reset").on("click",function(){pm.request.startNew()}),$("#request-method-selector").change(function(){var a=$(this).val();pm.request.setMethod(a)})},getTotalTime:function(){return this.totalTime=this.endTime-this.startTime,this.totalTime},response:{status:"",responseCode:[],time:0,headers:[],cookies:[],mime:"",text:"",state:{size:"normal"},previewType:"parsed",setMode:function(a){var b=pm.request.response.text;pm.request.response.setFormat(a,b,pm.settings.get("previewType"),!0)},stripScriptTag:function(a){var b=/<script\b[^>]*>([\s\S]*?)<\/script>/gm;return a=a.replace(b,"")},changePreviewType:function(a){if(this.previewType!==a)if(this.previewType=a,$("#response-formatting a").removeClass("active"),$('#response-formatting a[data-type="'+this.previewType+'"]').addClass("active"),pm.settings.set("previewType",a),"raw"===a){$("#response-as-text").css("display","block"),$("#response-as-code").css("display","none"),$("#response-as-preview").css("display","none"),$("#code-data-raw").val(this.text);var b=$(document).width()-$("#sidebar").width()-60;$("#code-data-raw").css("width",b+"px"),$("#code-data-raw").css("height","600px"),$("#response-pretty-modifiers").css("display","none")}else"parsed"===a?($("#response-as-text").css("display","none"),$("#response-as-code").css("display","block"),$("#response-as-preview").css("display","none"),$("#code-data").css("display","none"),$("#response-pretty-modifiers").css("display","block"),pm.editor.codeMirror.refresh()):"preview"===a&&($("#response-as-text").css("display","none"),$("#response-as-code").css("display","none"),$("#code-data").css("display","none"),$("#response-as-preview").css("display","block"),$("#response-pretty-modifiers").css("display","none"))},loadHeaders:function(a){if(this.headers=pm.request.unpackResponseHeaders(a),pm.settings.get("usePostmanProxy")===!0)for(var b=this.headers.length,c=0;b>c;c++)if("Postman-Location"==this.headers[c].key){this.headers[c].key="Location",this.headers[c].name="Location";break}$("#response-headers").html(""),this.headers=_.sortBy(this.headers,function(a){return a.name}),$("#response-headers").append(Handlebars.templates.response_headers({items:this.headers})),$(".response-header-name").popover({trigger:"hover"})},clear:function(){this.startTime=0,this.endTime=0,this.totalTime=0,this.status="",this.time=0,this.headers={},this.mime="",this.state.size="normal",this.previewType="parsed",$("#response").css("display","none")},showScreen:function(a){$("#response").css("display","block");for(var b="#response-"+a+"-container",c=["#response-waiting-container","#response-failed-container","#response-success-container"],d=0;3>d;d++)$(c[d]).css("display","none");$(b).css("display","block")},render:function(a){pm.request.response.showScreen("success"),$("#response-status").html(Handlebars.templates.item_response_code(a.responseCode)),$(".response-code").popover({trigger:"hover"}),$("#response-headers").append(Handlebars.templates.response_headers({items:a.headers})),$('.response-tabs li[data-section="headers"]').html("Headers ("+a.headers.length+")"),$("#response-data").css("display","block"),$("#loader").css("display","none"),$("#response-time .data").html(a.time+" ms");var b,c=find(a.headers,function(a,b,c){return"Content-Type"===a.key});c>=0&&(b=a.headers[c].value),$("#response").css("display","block"),$("#submit-request").button("reset"),$("#code-data").css("display","block");var d="html";pm.request.response.previewType=pm.settings.get("previewType");var e="html";if(_.isUndefined(b)||_.isNull(b))"javascript"==pm.settings.get("languageDetection")&&(d="javascript"),pm.request.response.setFormat(d,a.text,pm.settings.get("previewType"),!0);else if((-1!==b.search(/json/i)||-1!==b.search(/javascript/i)||"javascript"==pm.settings.get("languageDetection"))&&(d="javascript"),$("#language").val(d),b.search(/image/i)>=0){e="image",$("#response-as-code").css("display","none"),$("#response-as-text").css("display","none"),$("#response-as-image").css("display","block");var f=pm.request.processUrl($("#url").val());$("#response-formatting").css("display","none"),$("#response-actions").css("display","none"),$("#response-language").css("display","none"),$("#response-as-preview").css("display","none"),$("#response-pretty-modifiers").css("display","none"),$("#response-as-image").html("<img src='"+f+"'/>")}else e="html",pm.request.response.setFormat(d,a.text,pm.settings.get("previewType"),!0);if(pm.request.response.renderCookies(a.cookies),"html"===e){$("#response-as-preview").html("");var g=pm.request.response.stripScriptTag(pm.request.response.text);pm.filesystem.renderResponsePreview("response.html",g,"html",function(a){$("#response-as-preview").html("<iframe></iframe>"),$("#response-as-preview>iframe").attr("src",a).attr("height",800)})}"HEAD"===pm.request.method&&pm.request.response.showHeaders(),pm.request.isFromCollection===!0?$("#response-collection-request-actions").css("display","block"):$("#response-collection-request-actions").css("display","none"),$("#response-sample-status").css("display","block");var h=pm.request.response;h.time=a.time,h.cookies=a.cookies,h.headers=a.headers,h.text=a.text,h.responseCode=a.responseCode,$("#response-samples").css("display","block")},load:function(a){if($("#response-sample-status").css("display","none"),4==a.readyState){if(0==a.status){var b=pm.envManager.getCurrentValue(pm.request.url);return $("#connection-error-url").html("<a href='"+b+"' target='_blank'>"+b+"</a>"),pm.request.response.showScreen("failed"),$("#submit-request").button("reset"),!1}pm.request.response.showScreen("success"),pm.request.response.showBody();var c,d;a.status in httpStatusCodes?(c=httpStatusCodes[a.status].name,d=httpStatusCodes[a.status].detail):(c="",d=""),c="statusText"in a?a.statusText:httpStatusCodes[a.status].name;var e,f={code:a.status,name:c,detail:d};"arraybuffer"==a.responseRawDataType?e=a.response:this.text=a.responseText,pm.request.endTime=(new Date).getTime();var g=pm.request.getTotalTime();pm.request.response.time=g,pm.request.response.responseCode=f,$("#response-status").html(Handlebars.templates.item_response_code(f)),$(".response-code").popover({trigger:"hover"}),this.loadHeaders(a.getAllResponseHeaders()),$('.response-tabs li[data-section="headers"]').html("Headers ("+this.headers.length+")"),$("#response-data").css("display","block"),$("#loader").css("display","none"),$("#response-time .data").html(g+" ms");var h=a.getResponseHeader("Content-Type");$("#response").css("display","block"),$("#submit-request").button("reset"),$("#code-data").css("display","block");var i="html";pm.request.response.previewType=pm.settings.get("previewType");var j="html";if(_.isUndefined(h)||_.isNull(h))"javascript"==pm.settings.get("languageDetection")&&(i="javascript"),this.setFormat(i,this.text,pm.settings.get("previewType"),!0);else if((-1!==h.search(/json/i)||-1!==h.search(/javascript/i)||"javascript"==pm.settings.get("languageDetection"))&&(i="javascript"),$("#language").val(i),h.search(/image/i)>=0){j="image",$("#response-as-code").css("display","none"),$("#response-as-text").css("display","none"),$("#response-as-image").css("display","block");var k=pm.request.processUrl($("#url").val());$("#response-formatting").css("display","none"),$("#response-actions").css("display","none"),$("#response-language").css("display","none"),$("#response-as-preview").css("display","none"),$("#response-pretty-modifiers").css("display","none"),$("#response-as-image").html("<img src='"+k+"'/>")}else if(h.search(/pdf/i)>=0&&"arraybuffer"==a.responseRawDataType)j="pdf",$("#response-as-code").css("display","none"),$("#response-as-text").css("display","none"),$("#response-as-image").css("display","none"),$("#response-formatting").css("display","none"),$("#response-actions").css("display","none"),$("#response-language").css("display","none"),$("#response-as-preview").html(""),$("#response-as-preview").css("display","block"),$("#response-pretty-modifiers").css("display","none"),pm.filesystem.renderResponsePreview("response.pdf",e,"pdf",function(a){$("#response-as-preview").html("<iframe src='"+a+"'/>")});else{if(h.search(/pdf/i)>=0&&"text"==a.responseRawDataType)return void pm.request.send("arraybuffer");j="html",this.setFormat(i,this.text,pm.settings.get("previewType"),!0)}var l=pm.request.url;if(pm.request.response.loadCookies(l),"html"===j&&($("#response-as-preview").html(""),!pm.settings.get("disableIframePreview"))){var m=pm.request.response.stripScriptTag(pm.request.response.text);pm.filesystem.renderResponsePreview("response.html",m,"html",function(a){$("#response-as-preview").html("<iframe></iframe>"),$("#response-as-preview>iframe").attr("src",a).attr("height",800)})}"HEAD"===pm.request.method&&pm.request.response.showHeaders(),pm.request.isFromCollection===!0?$("#response-collection-request-actions").css("display","block"):$("#response-collection-request-actions").css("display","none")}return pm.layout.setLayout(),!0},renderCookies:function(a){var b=0;if(b=a?a.length:0,0===b)$("#response-tabs-cookies").html("Cookies"),$("#response-tabs-cookies").css("display","none");else{$("#response-tabs-cookies").html("Cookies ("+b+")"),$("#response-tabs-cookies").css("display","block"),a=_.sortBy(a,function(a){return a.name});for(var c=0;b>c;c++){var d=a[c];if("expirationDate"in d){var e=new Date(1e3*d.expirationDate);a[c].expires=e.toUTCString()}}$("#response-cookies-items").html(Handlebars.templates.response_cookies({items:a}))}pm.request.response.cookies=a},loadCookies:function(a){chrome.cookies.getAll({url:a},function(a){pm.request.response.renderCookies(a)})},setFormat:function(a,b,c,d){$("#response-as-code").css("display","block"),$("#response-as-text").css("display","none"),$("#response-as-image").css("display","none"),$("#response-formatting").css("display","block"),$("#response-actions").css("display","block"),$("#response-formatting a").removeClass("active"),$('#response-formatting a[data-type="'+c+'"]').addClass("active"),$("#code-data").css("display","none"),$("#code-data").attr("data-mime",a);var e,f,g=document.getElementById("code-data");if($("#response-language").css("display","block"),$("#response-language a").removeClass("active"),"javascript"===a){try{"string"==typeof b&&b.match(/^[\)\]\}]/)&&(b=b.substring(b.indexOf("\n"))),b=vkbeautify.json(b),f="javascript",e=CodeMirror.newFoldFunction(CodeMirror.braceRangeFinder);
}catch(h){f="text"}$('#response-language a[data-mode="javascript"]').addClass("active")}else"html"===a?(b=vkbeautify.xml(b),f="xml",e=CodeMirror.newFoldFunction(CodeMirror.tagRangeFinder),$('#response-language a[data-mode="html"]').addClass("active")):f="text";var i;pm.settings.get("lineWrapping")===!0?($("#response-body-line-wrapping").addClass("active"),i=!0):($("#response-body-line-wrapping").removeClass("active"),i=!1),pm.editor.mode=f;var j=f;if($.inArray(f,["javascript","xml","html"])>=0&&(j="links"),!pm.editor.codeMirror||d){$("#response .CodeMirror").remove(),pm.editor.codeMirror=CodeMirror.fromTextArea(g,{mode:j,lineNumbers:!0,fixedGutter:!0,onGutterClick:e,theme:"eclipse",lineWrapping:i,readOnly:!0});var k=pm.editor.codeMirror;k.setValue(b)}else pm.editor.codeMirror.setOption("onGutterClick",e),pm.editor.codeMirror.setOption("mode",j),pm.editor.codeMirror.setOption("lineWrapping",i),pm.editor.codeMirror.setOption("theme","eclipse"),pm.editor.codeMirror.setOption("readOnly",!1),pm.editor.codeMirror.setValue(b),pm.editor.codeMirror.refresh(),CodeMirror.commands.goDocStart(pm.editor.codeMirror),$(window).scrollTop(0);if("parsed"===c)$("#response-as-code").css("display","block"),$("#response-as-text").css("display","none"),$("#response-as-preview").css("display","none"),$("#response-pretty-modifiers").css("display","block");else if("raw"===c){$("#code-data-raw").val(b);var l=$(document).width()-$("#sidebar").width()-60;$("#code-data-raw").css("width",l+"px"),$("#code-data-raw").css("height","600px"),$("#response-as-code").css("display","none"),$("#response-as-text").css("display","block"),$("#response-pretty-modifiers").css("display","none")}else"preview"===c&&($("#response-as-code").css("display","none"),$("#response-as-text").css("display","none"),$("#response-as-preview").css("display","block"),$("#response-pretty-modifiers").css("display","none"))},toggleBodySize:function(){return"none"===$("#response").css("display")?!1:($('a[rel="tooltip"]').tooltip("hide"),void("normal"===this.state.size?(this.state.size="maximized",$("#response-body-toggle img").attr("src","img/full-screen-exit-alt-2.png"),this.state.width=$("#response-data").width(),this.state.height=$("#response-data").height(),this.state.display=$("#response-data").css("display"),this.state.position=$("#response-data").css("position"),$("#response-data").css("position","absolute"),$("#response-data").css("left",0),$("#response-data").css("top","-15px"),$("#response-data").css("width",$(document).width()-20),$("#response-data").css("height",$(document).height()),$("#response-data").css("z-index",100),$("#response-data").css("background-color","#fff"),$("#response-data").css("padding","10px")):(this.state.size="normal",$("#response-body-toggle img").attr("src","img/full-screen-alt-4.png"),$("#response-data").css("position",this.state.position),$("#response-data").css("left",0),$("#response-data").css("top",0),$("#response-data").css("width",this.state.width),$("#response-data").css("height",this.state.height),$("#response-data").css("z-index",10),$("#response-data").css("background-color","#fff"),$("#response-data").css("padding","0px"))))},showHeaders:function(){$(".response-tabs li").removeClass("active"),$('.response-tabs li[data-section="headers"]').addClass("active"),$("#response-data-container").css("display","none"),$("#response-headers-container").css("display","block"),$("#response-cookies-container").css("display","none")},showBody:function(){$(".response-tabs li").removeClass("active"),$('.response-tabs li[data-section="body"]').addClass("active"),$("#response-data-container").css("display","block"),$("#response-headers-container").css("display","none"),$("#response-cookies-container").css("display","none")},showCookies:function(){$(".response-tabs li").removeClass("active"),$('.response-tabs li[data-section="cookies"]').addClass("active"),$("#response-data-container").css("display","none"),$("#response-headers-container").css("display","none"),$("#response-cookies-container").css("display","block")},openInNewWindow:function(a){var b="response.html",c="text/html";pm.filesystem.saveAndOpenFile(b,a,c,function(){})}},startNew:function(){pm.request.showRequestBuilder(),$(".sidebar-collection-request").removeClass("sidebar-collection-request-active"),null!==pm.request.xhr&&pm.request.xhr.abort(),this.url="",this.urlParams={},this.body.data="",this.bodyParams={},this.name="",this.description="",this.headers=[],this.method="GET",this.dataMode="params",this.refreshLayout(),$("#url-keyvaleditor").keyvalueeditor("reset"),$("#headers-keyvaleditor").keyvalueeditor("reset"),$("#formdata-keyvaleditor").keyvalueeditor("reset"),$("#update-request-in-collection").css("display","none"),$("#url").val(),$("#url").focus(),this.response.clear()},cancel:function(){null!==pm.request.xhr&&pm.request.xhr.abort(),pm.request.response.clear()},setMethod:function(a){this.url=$("#url").val(),this.method=a,this.refreshLayout()},refreshLayout:function(){if($("#url").val(this.url),$("#request-method-selector").val(this.method),pm.request.body.loadRawData(pm.request.body.getData()),$("#headers-keyvaleditor").keyvalueeditor("reset",this.headers),$("#headers-keyvaleditor-actions-open .headers-count").html(this.headers.length),$("#submit-request").button("reset"),$("#data-mode-selector a").removeClass("active"),$('#data-mode-selector a[data-mode="'+this.dataMode+'"]').addClass("active"),this.isMethodWithBody(this.method)){$("#data").css("display","block");var a=this.dataMode;pm.request.body.setDataMode(a)}else pm.request.body.hide();""!==this.name?($("#request-meta").css("display","block"),$("#request-name").css("display","inline-block"),"block"===$("#request-description").css("display")?$("#request-description").css("display","block"):$("#request-description").css("display","none")):($("#request-meta").css("display","none"),$("#request-name").css("display","none"),$("#request-description").css("display","none"),$("#request-samples").css("display","none")),$(".request-help-actions-togglesize a").attr("data-action","minimize"),$(".request-help-actions-togglesize img").attr("src","img/circle_minus.png")},loadRequestFromLink:function(a,b){this.startNew(),this.url=a,this.method="GET",pm.request.isFromCollection=!1,pm.settings.get("retainLinkHeaders")===!0&&b&&(pm.request.headers=b),this.refreshLayout()},isMethodWithBody:function(a){return a=a.toUpperCase(),$.inArray(a,pm.request.methodsWithBody)>=0},packHeaders:function(a){for(var b=a.length,c="",d=0;b>d;d++){var e=a[d];e.name&&""!==e.name&&(c+=e.name+": "+e.value+"\n")}return c},getPackedHeaders:function(){return this.packHeaders(this.headers)},unpackResponseHeaders:function(a){if(null===a||""===a)return[];for(var b,c,d=[],e=a.split("\n"),f=0;f<e.length;f++){b=e[f];var g=b.search(":");if(-1!==g){var h=$.trim(b.substr(0,g)),i=$.trim(b.substr(g+1));c={name:h,key:h,value:i,description:headerDetails[h.toLowerCase()]},d.push(c)}}return d},unpackHeaders:function(a){if(null===a||""===a)return[];for(var b,c,d=[],e=a.split("\n"),f=0;f<e.length;f++)if(b=e[f]){var g=b.search(":");if(-1!==g){var h=$.trim(b.substr(0,g)),i=$.trim(b.substr(g+1));c={name:$.trim(h),key:$.trim(h),value:$.trim(i),description:headerDetails[$.trim(h).toLowerCase()]},d.push(c)}}return d},loadRequestInEditor:function(a,b,c){pm.request.showRequestBuilder(),pm.helpers.showRequestHelper("normal"),this.url=a.url,this.body.data=a.body,this.method=a.method.toUpperCase(),b?($("#update-request-in-collection").css("display","inline-block"),"undefined"!=typeof a.name?(this.name=a.name,$("#request-meta").css("display","block"),$("#request-name").html(this.name),$("#request-name").css("display","inline-block")):(this.name="",$("#request-meta").css("display","none"),$("#request-name").css("display","none")),"undefined"!=typeof a.description?(this.description=a.description,$("#request-description").html(this.description),$("#request-description").css("display","block")):(this.description="",$("#request-description").css("display","none")),$("#response-sample-save-form").css("display","none"),$(".request-meta-actions-togglesize").attr("data-action","minimize"),$(".request-meta-actions-togglesize img").attr("src","img/circle_minus.png"),"responses"in a?(pm.request.responses=a.responses,$("#request-samples").css("display","block"),a.responses?a.responses.length>0?($("#request-samples table").html(""),$("#request-samples table").append(Handlebars.templates.sample_responses({items:a.responses}))):($("#request-samples table").html(""),$("#request-samples").css("display","none")):(pm.request.responses=[],$("#request-samples table").html(""),$("#request-samples").css("display","none"))):(pm.request.responses=[],$("#request-samples table").html(""),$("#request-samples").css("display","none"))):c?$("#update-request-in-collection").css("display","inline-block"):(this.name="",$("#request-meta").css("display","none"),$("#update-request-in-collection").css("display","none")),"undefined"!=typeof a.headers?this.headers=this.unpackHeaders(a.headers):this.headers=[],$("#headers-keyvaleditor-actions-open .headers-count").html(this.headers.length),$("#url").val(this.url);var d=getUrlVars(this.url,!1);$("#url-keyvaleditor").keyvalueeditor("reset",d),$("#headers-keyvaleditor").keyvalueeditor("reset",this.headers),this.response.clear(),$("#request-method-selector").val(this.method),this.isMethodWithBody(this.method)?(this.dataMode=a.dataMode,$("#data").css("display","block"),"version"in a&&2==a.version?pm.request.body.loadData(a.dataMode,a.data,!0):pm.request.body.loadData(a.dataMode,a.data)):$("#data").css("display","none");var e,f,g=pm.request.getHeaderValue("Content-Type");g===!1?(e="text",f="text"):-1!==g.search(/json/i)||-1!==g.search(/javascript/i)?(e="javascript",f="json"):-1!==g.search(/xml/i)?(e="xml",f="xml"):-1!==g.search(/html/i)?(e="xml",f="html"):(f="text",g="text"),pm.request.body.setEditorMode(e,f),$("body").scrollTop(0)},getBodyParamString:function(a){for(var b=a.length,c=[],d=0;b>d;d++){var e=a[d];e.key&&""!==e.key&&c.push(e.key+"="+e.value)}return c.join("&")},setUrlParamString:function(a){this.url=$("#url").val();for(var b=this.url,c=[],d=0;d<a.length;d++){var e=a[d];e.key&&""!==e.key&&c.push(e.key+"="+e.value)}var f=b.split("?")[0];c.length>0?$("#url").val(f+"?"+c.join("&")):b.indexOf("?")>0&&b.indexOf("=")>0?$("#url").val(f):$("#url").val(b)},reset:function(){},encodeUrl:function(a){var b=a.indexOf("?");if(b>0){for(var c=getUrlVars(a),d=a.substring(0,b),e=c.length,f=d+"?",g=0;e>g;g++)f+=encodeURIComponent(c[g].key)+"="+encodeURIComponent(c[g].value)+"&";return f=f.substr(0,f.length-1),a}return a},prepareHeadersForProxy:function(a){for(var b=a.length,c=0;b>c;c++){var d=a[c].key.toLowerCase();_.indexOf(pm.bannedHeaders,d)>=0&&(a[c].key="Postman-"+a[c].key,a[c].name="Postman-"+a[c].name)}return a},processUrl:function(a){var b=pm.envManager.getCurrentValue(a);return b=ensureProperUrl(b)},prepareForSending:function(){pm.request.setUrlParamString(pm.request.getUrlEditorParams()),"oauth1"==pm.helpers.activeHelper&&pm.helpers.oAuth1.isAutoEnabled&&(pm.helpers.oAuth1.generateHelper(),pm.helpers.oAuth1.process()),$("#headers-keyvaleditor-actions-open .headers-count").html(pm.request.headers.length),pm.request.url=pm.request.processUrl($("#url").val()),pm.request.startTime=(new Date).getTime()},getXhrHeaders:function(){pm.request.headers=pm.request.getHeaderEditorParams();var a=pm.request.getHeaderEditorParams();if(pm.settings.get("sendNoCacheHeader")===!0){var b={key:"Cache-Control",name:"Cache-Control",value:"no-cache"};a.push(b)}if("urlencoded"===pm.request.dataMode){var c={key:"Content-Type",name:"Content-Type",value:"application/x-www-form-urlencoded"};a.push(c)}1==pm.settings.get("usePostmanProxy")&&(a=pm.request.prepareHeadersForProxy(a));var d,e=[];for(d=0;d<a.length;d++){var f=a[d];_.isEmpty(f.value)||(f.value=pm.envManager.getCurrentValue(f.value),e.push(f))}return e},getDummyFormDataBoundary:function(){var a="----WebKitFormBoundaryE19zNvXGzXaLvS5C";return a},getFormDataPreview:function(){var a,b,c,d,e,f,g;a=$("#formdata-keyvaleditor").keyvalueeditor("getElements"),b=a.length;var h=[];if(b>0){for(c=0;b>c;c++){d=a[c],e=d.keyElement.val();var i=d.valueType,j=d.valueElement;if("file"===i){var k=j.get(0),l=k.files.length;for(g=0;l>g;g++){var m={key:e,value:k.files[g],type:"file"};h.push(m)}}else{f=j.val(),f=pm.envManager.getCurrentValue(f);var n={key:e,value:f,type:"text"};h.push(n)}}console.log(h);var o=h.length,p="";for(g=0;o>g;g++){var q=h[g];console.log(q),p+=pm.request.getDummyFormDataBoundary(),"text"===q.type?(p+='<br/>Content-Disposition: form-data; name="'+q.key+'"<br/><br/>',p+=q.value,p+="<br/>"):"file"===q.type&&(p+='<br/>Content-Disposition: form-data; name="'+q.key+'"; filename=',p+='"'+q.value.name+'"<br/>',p+="Content-Type: "+q.value.type,p+="<br/><br/><br/>")}return p+=pm.request.getDummyFormDataBoundary()}return!1},getFormDataBody:function(){var a,b,c,d,e,f,g,h=new FormData;if(a=$("#formdata-keyvaleditor").keyvalueeditor("getElements"),b=a.length,b>0){for(c=0;b>c;c++){e=a[c],f=e.keyElement.val();var i=e.valueType,j=e.valueElement;if("file"===i){var k=j.get(0),l=k.files.length;for(d=0;l>d;d++)h.append(f,k.files[d])}else g=j.val(),g=pm.envManager.getCurrentValue(g),h.append(f,g)}return h}return!1},getUrlEncodedBody:function(){var a,b,c,d,e,f,g="";if(a=$("#urlencoded-keyvaleditor").keyvalueeditor("getElements"),b=a.length,b>0){for(c=0;b>c;c++)d=a[c],f=d.valueElement.val(),f=pm.envManager.getCurrentValue(f),f=encodeURIComponent(f),f=f.replace(/%20/g,"+"),e=encodeURIComponent(d.keyElement.val()),e=e.replace(/%20/g,"+"),g+=e+"="+f+"&";return g=g.substr(0,g.length-1)}return!1},getRequestBodyPreview:function(){if("raw"===pm.request.dataMode){var a=pm.request.body.getData(!0);return a=pm.envManager.getCurrentValue(a)}if("params"===pm.request.dataMode){var b=pm.request.getFormDataPreview();return b!==!1?b:!1}if("urlencoded"===pm.request.dataMode){var c=pm.request.getUrlEncodedBody();return c!==!1?c:!1}},getRequestBodyToBeSent:function(){if("raw"===pm.request.dataMode){var a=pm.request.body.getData(!0);return a=pm.envManager.getCurrentValue(a)}if("params"===pm.request.dataMode){var b=pm.request.getFormDataBody();return b!==!1?b:!1}if("urlencoded"===pm.request.dataMode){var c=pm.request.getUrlEncodedBody();return c!==!1?c:!1}},send:function(a){if(pm.request.prepareForSending(),""!==pm.request.url){var b=$("#url").val(),c=pm.request.encodeUrl(pm.request.url),d=pm.request.method.toUpperCase(),e=pm.request.body.getData(!0),f=new XMLHttpRequest;f.open(d,c,!0),f.onreadystatechange=function(a){pm.request.response.load(a.target)},a||(a="text"),f.responseType=a;for(var g=pm.request.getXhrHeaders(g),h=0;h<g.length;h++)f.setRequestHeader(g[h].name,g[h].value);var i=$("#request-helper-basicAuth-username").val(),j=$("#request-helper-basicAuth-password").val();i=pm.envManager.convertString(i),j=pm.envManager.convertString(j);var k=pm.request.getRequestBodyToBeSent(),l=new Lcp.GenerateAuthHeader(d,c,i,j,"application/json",k);if(f.setRequestHeader("Authorization",l.header),pm.request.isMethodWithBody(d)){var m=pm.request.getRequestBodyToBeSent();m===!1?f.send():f.send(m)}else f.send();pm.request.xhr=f,pm.settings.get("autoSaveRequest")&&pm.history.addRequest(b,d,pm.request.getPackedHeaders(),e,pm.request.dataMode),pm.request.updateUiPostSending()}},updateUiPostSending:function(){$("#submit-request").button("loading"),pm.request.response.clear(),pm.request.response.showScreen("waiting")},splitUrlIntoHostAndPath:function(a){var b,c="",d=a.split("/");b=d[2];for(var e=d.length,f=3;e>f;f++)c+="/"+d[f];return{host:b,path:c}},showRequestBuilder:function(){$("#preview-request").html("Preview"),pm.request.editorMode=0,$("#request-builder").css("display","block"),$("#request-preview").css("display","none")},showPreview:function(){$("#preview-request").html("Build"),pm.request.editorMode=1,$("#request-builder").css("display","none"),$("#request-preview").css("display","block")},handlePreviewClick:function(){1==pm.request.editorMode?pm.request.showRequestBuilder():pm.request.showPreview(),pm.request.prepareForSending();var a,b=pm.request.method.toUpperCase(),c="HTTP/1.1",d=pm.request.splitUrlIntoHostAndPath(pm.request.url),e=d.path,f=d.host,g=pm.request.getXhrHeaders(),h=pm.request.isMethodWithBody(pm.request.method.toUpperCase());h&&(a=pm.request.getRequestBodyPreview());var i=b+" "+e+" "+c+"<br/>";i+="Host: "+f+"<br/>";for(var j=g.length,k=0;j>k;k++)i+=g[k].key+": "+g[k].value+"<br/>";i+=h&&a!==!1?"<br/>"+a+"<br/><br/>":"<br/><br/>",$("#request-preview-content").html(i)}},pm.settings={historyCount:50,lastRequest:"",autoSaveRequest:!0,selectedEnvironmentId:"",createSettings:function(){pm.settings.create("historyCount",100),pm.settings.create("autoSaveRequest",!0),pm.settings.create("selectedEnvironmentId",!0),pm.settings.create("lineWrapping",!0),pm.settings.create("disableIframePreview",!1),pm.settings.create("previewType","parsed"),pm.settings.create("retainLinkHeaders",!1),pm.settings.create("sendNoCacheHeader",!0),pm.settings.create("usePostmanProxy",!1),pm.settings.create("proxyURL",""),pm.settings.create("lastRequest",""),pm.settings.create("launcherNotificationCount",0),pm.settings.create("variableDelimiter","{{...}}"),pm.settings.create("languageDetection","auto"),pm.settings.create("haveDonated",!1)},initValues:function(){$("#history-count").val(pm.settings.get("historyCount")),$("#auto-save-request").val(pm.settings.get("autoSaveRequest")+""),$("#retain-link-headers").val(pm.settings.get("retainLinkHeaders")+""),$("#send-no-cache-header").val(pm.settings.get("sendNoCacheHeader")+""),$("#use-postman-proxy").val(pm.settings.get("usePostmanProxy")+""),$("#postman-proxy-url").val(pm.settings.get("postmanProxyUrl")),$("#variable-delimiter").val(pm.settings.get("variableDelimiter")),$("#language-detection").val(pm.settings.get("languageDetection")),$("#have-donated").val(pm.settings.get("haveDonated")+""),$("#disable-iframe-preview").val(pm.settings.get("disableIframePreview")+"")},initListeners:function(){$("#history-count").change(function(){pm.settings.set("historyCount",$("#history-count").val())}),$("#auto-save-request").change(function(){var a=$("#auto-save-request").val();"true"==a?pm.settings.set("autoSaveRequest",!0):pm.settings.set("autoSaveRequest",!1)}),$("#retain-link-headers").change(function(){var a=$("#retain-link-headers").val();"true"===a?pm.settings.set("retainLinkHeaders",!0):pm.settings.set("retainLinkHeaders",!1)}),$("#send-no-cache-header").change(function(){var a=$("#send-no-cache-header").val();"true"==a?pm.settings.set("sendNoCacheHeader",!0):pm.settings.set("sendNoCacheHeader",!1)}),$("#use-postman-proxy").change(function(){var a=$("#use-postman-proxy").val();"true"==a?(pm.settings.set("usePostmanProxy",!0),$("#postman-proxy-url-container").css("display","block")):(pm.settings.set("usePostmanProxy",!1),$("#postman-proxy-url-container").css("display","none"))}),$("#disable-iframe-preview").change(function(){var a=$("#disable-iframe-preview").val();"true"==a?pm.settings.set("disableIframePreview",!0):pm.settings.set("disableIframePreview",!1)}),$("#postman-proxy-url").change(function(){pm.settings.set("postmanProxyUrl",$("#postman-proxy-url").val())}),$("#variable-delimiter").change(function(){pm.settings.set("variableDelimiter",$("#variable-delimiter").val())}),$("#language-detection").change(function(){pm.settings.set("languageDetection",$("#language-detection").val())}),$("#have-donated").change(function(){var a=$("#have-donated").val();"true"==a?(pm.layout.hideDonationBar(),pm.settings.set("haveDonated",!0)):pm.settings.set("haveDonated",!1)}),1==pm.settings.get("usePostmanProxy")?$("#postman-proxy-url-container").css("display","block"):$("#postman-proxy-url-container").css("display","none")},init:function(){pm.settings.createSettings(),pm.settings.initValues(),pm.settings.initListeners()},create:function(a,b){localStorage[a]?pm.settings[a]=localStorage[a]:"undefined"!==b&&(pm.settings[a]=b,localStorage[a]=b)},set:function(a,b){pm.settings[a]=b,localStorage[a]=b},get:function(a){var b=localStorage[a];return"true"===b?!0:"false"===b?!1:localStorage[a]}},pm.urlCache={urls:[],addUrl:function(a){-1==$.inArray(a,this.urls)&&(pm.urlCache.urls.push(a),this.refreshAutoComplete())},refreshAutoComplete:function(){$("#url").autocomplete({source:pm.urlCache.urls,delay:50})}};